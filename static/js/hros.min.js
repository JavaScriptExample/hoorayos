var version="3.3.3";var ajaxUrl="ajax.php";var TEMP={};var HROS={};HROS.CONFIG={website:"http://"+location.hostname+location.pathname,memberID:0,desk:1,dockPos:"",appXY:"",appSize:48,appMarginTop:20,appMarginLeft:20,appVerticalSpacing:50,appHorizontalSpacing:50,windowIndexid:1e4,widgetIndexid:1,windowMinWidth:215,windowMinHeight:59,wallpaperState:1,wallpaper:"",wallpaperType:"",wallpaperWidth:0,wallpaperHeight:0};HROS.VAR={zoomLevel:1,isAppMoving:false,dock:[],desk1:[],desk2:[],desk3:[],desk4:[],desk5:[],folder:[]};var appbtnTemp=template.compile('<div id="<%=id%>" class="appbtn" title="<%=title%>" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>">'+'<img src="<%=imgsrc%>" alt="<%=title%>" style="width:<%=appsize%>px;height:<%=appsize%>px;">'+'<span style="width:<%=appsize+10%>px;"><%=title%></span>'+"</div>");var addbtnTemp=template.compile('<div class="appbtn add">'+'<img src="static/img/ui/addicon.png" style="width:<%=appsize%>px;height:<%=appsize%>px;">'+'<span style="width:<%=appsize+10%>px;">添加应用</span>'+"</div>");var taskTemp=template.compile('<a id="<%=id%>" class="task-item task-item-current" title="<%=title%>" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>">'+'<div class="task-item-icon">'+'<img src="<%=imgsrc%>" alt="<%=title%>">'+"</div>"+'<div class="task-item-txt"><%=title%></div>'+"</a>");var widgetWindowTemp=template.compile('<div id="<%=id%>" class="widget" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>" style="z-index:<%=zIndex%>;width:<%=width%>px;height:<%=height%>px;top:<%=top%>px;right:<%=right%>px">'+'<div class="move">'+'<a class="ha-close" href="javascript:;" title="关闭"></a>'+"<% if(issetbar){ %>"+'<a class="ha-star" href="javascript:;" title="评分"></a>'+'<a class="ha-share" href="javascript:;" title="分享"></a>'+"<% } %>"+"</div>"+'<div class="frame">'+'<iframe src="<%=url%>" frameborder="0" allowtransparency="true"></iframe>'+"</div>"+"</div>");var windowTemp=template.compile('<div id="<%=id%>" class="window-container window-current<% if(isflash){ %> window-container-flash<% } %>" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>" state="show" style="<% if(isopenmax){ %>width:100%;height:100%;<% }else{ %>width:<%=width%>px;height:<%=height%>px;<% } %>z-index:<%=zIndex%>" ismax="<% if(isopenmax){ %>1<% }else{ %>0<% } %>">'+'<div style="height:100%">'+'<div class="title-bar">'+'<img class="icon" src="<%=imgsrc%>" alt="<%=title%>"><span class="title"><%=title%></span>'+'<div class="title-handle">'+'<a class="ha-hide" btn="hide" href="javascript:;" title="最小化"><b class="hide-b"></b></a>'+"<% if(istitlebar){ %>"+'<a class="ha-max" btn="max" href="javascript:;" title="最大化" <% if(isopenmax){ %>style="display:none"<% } %>><b class="max-b"></b></a>'+'<a class="ha-revert" btn="revert" href="javascript:;" title="还原" <% if(!isopenmax){ %>style="display:none"<% } %>><b class="revert-b"></b><b class="revert-t"></b></a>'+"<% } %>"+"<% if(istitlebarFullscreen){ %>"+'<a class="ha-fullscreen" btn="fullscreen" href="javascript:;" title="全屏">+</a>'+"<% } %>"+'<a class="ha-close" btn="close" href="javascript:;" title="关闭">×</a>'+"</div>"+"</div>"+'<div class="window-frame">'+"<% if(isflash){ %>"+'<div class="window-mask"><div class="maskbg"></div><div>运行中，点击恢复显示 :)</div></div>'+"<% }else{ %>"+'<div class="window-mask window-mask-noflash"></div>'+"<% } %>"+'<iframe id="<%=id%>_iframe" frameborder="0" src="<%=url%>"></iframe>'+"</div>"+'<div class="set-bar"><div class="fr">'+"<% if(issetbar){ %>"+'<a class="btn share"><i class="fa fa-share-alt"></i><span class="btn-con">分享</span></a>'+'<a class="btn star"><i class="fa fa-star"></i><span class="btn-con">评分</span></a>'+'<a class="btn detail"><i class="fa fa-info-circle"></i><span class="btn-con">详情</span></a>'+"<% } %>"+'<a class="btn refresh"><i class="fa fa-refresh"></i><span class="btn-con">刷新</span></a>'+"</div></div>"+"</div>"+"<% if(isresize){ %>"+'<div class="window-resize window-resize-t" resize="t"></div>'+'<div class="window-resize window-resize-r" resize="r"></div>'+'<div class="window-resize window-resize-b" resize="b"></div>'+'<div class="window-resize window-resize-l" resize="l"></div>'+'<div class="window-resize window-resize-rt" resize="rt"></div>'+'<div class="window-resize window-resize-rb" resize="rb"></div>'+'<div class="window-resize window-resize-lt" resize="lt"></div>'+'<div class="window-resize window-resize-lb" resize="lb"></div>'+"<% } %>"+"</div>");var folderWindowTemp=template.compile('<div id="<%=id%>" class="folder-window window-container window-current" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>" state="show" style="width:<%=width%>px;height:<%=height%>px;z-index:<%=zIndex%>">'+'<div style="height:100%">'+'<div class="title-bar">'+'<img class="icon" src="<%=imgsrc%>" alt="<%=title%>"><span class="title"><%=title%></span>'+'<div class="title-handle">'+'<a class="ha-hide" btn="hide" href="javascript:;" title="最小化"><b class="hide-b"></b></a>'+"<% if(istitlebar){ %>"+'<a class="ha-max" btn="max" href="javascript:;" title="最大化"><b class="max-b"></b></a>'+'<a class="ha-revert" btn="revert" href="javascript:;" title="还原" style="display:none"><b class="revert-b"></b><b class="revert-t"></b></a>'+"<% } %>"+'<a class="ha-close" btn="close" href="javascript:;" title="关闭">×</a>'+"</div>"+"</div>"+'<div class="window-frame">'+'<div class="folder_body"></div>'+"</div>"+'<div class="set-bar"><div class="fr">'+'<a class="btn refresh"><i class="icon icon158"></i><span class="btn-con">刷新</span></a>'+"</div></div>"+"</div>"+"<% if(isresize){ %>"+'<div class="window-resize window-resize-t" resize="t"></div>'+'<div class="window-resize window-resize-r" resize="r"></div>'+'<div class="window-resize window-resize-b" resize="b"></div>'+'<div class="window-resize window-resize-l" resize="l"></div>'+'<div class="window-resize window-resize-rt" resize="rt"></div>'+'<div class="window-resize window-resize-rb" resize="rb"></div>'+'<div class="window-resize window-resize-lt" resize="lt"></div>'+'<div class="window-resize window-resize-lb" resize="lb"></div>'+"<% } %>"+"</div>");var folderViewTemp=template.compile('<div id="<%=id%>" class="quick_view_container" appid="<%=appid%>" realappid="<%=realappid%>" style="top:<%=top%>px;left:<%=left%>px">'+'<div class="perfect_nine_box">'+'<div class="perfect_nine_t">'+'<div class="perfect_nine_t_m"></div>'+"</div>"+'<span class="perfect_nine_t_l"></span>'+'<span class="perfect_nine_t_r"></span>'+'<div class="perfect_nine_middle">'+'<span class="perfect_nine_m_l">'+'<div class="perfect_nine_m_l_t" style="top:0px;height:<%=mlt%>px"></div>'+'<div class="perfect_nine_m_l_m" style="top:<%=mlt%>px;height:20px;display:<% if(mlm){ %>block<% }else{ %>none<% } %>"></div>'+'<div class="perfect_nine_m_l_b" style="top:<% if(mlm){ %><%=mlt+20%><% }else{ %><%=mlt%><% } %>px;height:<%=mlb%>px"></div>'+"</span>"+'<span class="perfect_nine_m_r">'+'<div class="perfect_nine_m_r_t" style="top:0px;height:<%=mrt%>px"></div>'+'<div class="perfect_nine_m_r_m" style="top:<%=mrt%>px;height:20px;display:<% if(mrm){ %>block<% }else{ %>none<% } %>"></div>'+'<div class="perfect_nine_m_r_b" style="top:<% if(mrm){ %><%=mrt+20%><% }else{ %><%=mrt%><% } %>px;height:<%=mrb%>px"></div>'+"</span>"+'<div class="perfect_nine_context">'+'<div class="quick_view_container_control">'+'<a href="javascript:;" class="quick_view_container_open">打开</a>'+"</div>"+'<div class="quick_view_container_list" id="quick_view_container_list_<%=appid%>" realid="<%=appid%>">'+'<div class="quick_view_container_list_in" id="quick_view_container_list_in_<%=appid%>" style="height:<%=height%>px">'+"<%==apps%>"+"</div>"+'<div class="scrollBar"></div>'+'<div class="scrollBar_bgc"></div>'+"</div>"+"</div>"+"</div>"+'<div class="perfect_nine_b">'+'<div class="perfect_nine_b_m"></div>'+"</div>"+'<span class="perfect_nine_b_l"></span>'+'<span class="perfect_nine_b_r"></span>'+"</div>"+"</div>");var fileDownloadTemp=template.compile('<iframe src="filedownload.php?appid=<%=appid%>" frameborder="0" style="display:none"></iframe>');var suggestTemp=template.compile('<li class="resultList" appid="<%=appid%>" realappid="<%=realappid%>" type="<%=type%>">'+'<a href="javascript:;"><div><%=name%></div></a>'+"</li>");var starDialogTemp=template.compile('<div id="star" realappid="<%=realappid%>">'+'<div class="grade-box">'+'<div class="star-num"><%=point%></div>'+'<div class="star-box">'+"<div>打分：</div>"+'<i style="width:<%=realpoint%>%"></i>'+"<ul>"+'<li class="grade-1" num="1"><a href="javascript:;"><em>很不好用</em></a></li>'+'<li class="grade-2" num="2"><a href="javascript:;"><em>体验一般般</em></a></li>'+'<li class="grade-3" num="3"><a href="javascript:;"><em>比较好用</em></a></li>'+'<li class="grade-4" num="4"><a href="javascript:;"><em>很好用</em></a></li>'+'<li class="grade-5" num="5"><a href="javascript:;"><em>棒极了，推荐</em></a></li>'+"</ul>"+"</div>"+"</div>"+"</div>");var shareDialogTemp=template.compile('<div id="share">'+'<a class="tsina" href="http://service.weibo.com/share/share.php?title=<%=title%>&url=<%=url%>&searchPic=true" target="_blank">新浪微博</a>'+'<a class="tqq" href="http://v.t.qq.com/share/share.php?title=<%=title%>&url=<%=url%>" target="_blank">腾讯微博</a>'+'<a class="tsohu" href="http://t.sohu.com/third/post.jsp?url=<%=url%>&title=<%=title%>&content=utf-8" target="_blank">搜狐微博</a>'+'<a class="twangyi" href="http://t.163.com/article/user/checkLogin.do?info=<%=title%>+<%=url%>" target="_blank">网易微博</a>'+'<a class="qzone" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=<%=url%>&title=<%=title%>" target="_blank">QQ空间</a>'+'<a class="renren" href="http://share.renren.com/share/buttonshare.do?link=<%=url%>&title=<%=title%>" target="_blank">人人网</a>'+'<a class="baidu" href="http://cang.baidu.com/do/add?it=<%=title%>&iu=<%=url%>" target="_blank">百度收藏</a>'+'<a class="douban" href="http://shuo.douban.com/!service/share?image=&href=<%=url%>&name=<%=title%>" target="_blank">豆瓣</a>'+"</div>");var lockTemp=template.compile('<div id="lock">'+'<div class="title">'+'<div class="time"></div>'+'<div class="week"></div>'+"</div>"+'<div id="lock-info">'+'<div class="img"><img src="<%=avatar%>" title="<%=username%>" alt="<%=username%>"></img></div>'+'<div class="text"><input type="password" id="lockpassword" placeholder="请输入解锁密码"></div>'+'<div class="text-tip"></div>'+'<div class="text"><input type="button" id="lockbtn" value="解 锁"></div>'+"</div>"+'<div class="tip">点击屏幕，开启解锁</div>'+"</div>");HROS.app=function(){return{init:function(){$("#desk").on("click",".add",function(){HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php",width:800,height:484,isflash:false})});HROS.app.move();HROS.app.moveScrollbar();$("body").on("contextmenu",".appbtn:not(.add)",function(e){HROS.popupMenu.hide();var t;switch($(this).attr("type")){case"window":case"widget":t=HROS.popupMenu.app($(this));break;case"pwindow":case"pwidget":t=HROS.popupMenu.papp($(this));break;case"folder":t=HROS.popupMenu.folder($(this));break;case"file":t=HROS.popupMenu.file($(this));break}var i=$(window).width()-e.clientX<t.width()?e.clientX-t.width():e.clientX;var a=$(window).height()-e.clientY<t.height()?e.clientY-t.height():e.clientY;t.css({left:i,top:a}).show();return false});$("body").on("click","#star ul li",function(){var e=$(this).attr("num");if(!isNaN(e)&&/^[1-5]$/.test(e)){if(HROS.base.checkLogin()){$.ajax({data:"ac=updateAppStar&id="+$("#star").attr("realappid")+"&starnum="+e}).done(function(e){dialog.get("star").close().remove();if(e["response"]){swal({type:"success",title:"打分成功",timer:2e3,showConfirmButton:false})}else{swal({type:"warning",title:"你已经打过分了",timer:2e3,showConfirmButton:false})}})}else{HROS.base.login()}}}).on("click","#share a",function(){dialog.get("share").close().remove()});HROS.app.get()},updateXY:function(e){if(HROS.CONFIG.appXY!=e){HROS.CONFIG.appXY=e;HROS.deskTop.resize();if(HROS.base.checkLogin()){$.ajax({data:"ac=setAppXY&appxy="+e})}}},updateSize:function(e){if(HROS.CONFIG.appSize!=e){HROS.CONFIG.appSize=e;HROS.deskTop.resize();if(HROS.base.checkLogin()){$.ajax({data:"ac=setAppSize&appsize="+e})}}},updateVertical:function(e){if(HROS.CONFIG.appVerticalSpacing!=e){HROS.CONFIG.appVerticalSpacing=e;HROS.deskTop.resize();if(HROS.base.checkLogin()){$.ajax({data:"ac=setAppVerticalSpacing&appverticalspacing="+e})}}},updateHorizontal:function(e){if(HROS.CONFIG.appHorizontalSpacing!=e){HROS.CONFIG.appHorizontalSpacing=e;HROS.deskTop.resize();if(HROS.base.checkLogin()){$.ajax({data:"ac=setAppHorizontalSpacing&apphorizontalspacing="+e})}}},get:function(){$.ajax({data:"ac=getMyApp",dataType:"json",beforeSend:function(){HROS.VAR.isAppMoving=true}}).done(function(e){HROS.VAR.isAppMoving=false;if(typeof e=="object"){if(typeof e["dock"]=="object"){HROS.VAR.dock=e["dock"]}if(typeof e["desk1"]=="object"){HROS.VAR.desk1=e["desk1"]}if(typeof e["desk2"]=="object"){HROS.VAR.desk2=e["desk2"]}if(typeof e["desk3"]=="object"){HROS.VAR.desk3=e["desk3"]}if(typeof e["desk4"]=="object"){HROS.VAR.desk4=e["desk4"]}if(typeof e["desk5"]=="object"){HROS.VAR.desk5=e["desk5"]}if(typeof e["folder"]=="object"){HROS.VAR.folder=e["folder"]}}HROS.app.set()})},set:function(){var dock_append="";if(HROS.VAR.dock!=""){$(HROS.VAR.dock).each(function(){dock_append+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid==0?this.appid:this.realappid,imgsrc:this.icon,appsize:48})})}$("#dock-bar .dock-applist .appbtn").remove();$("#dock-bar .dock-applist").append(dock_append);for(var j=1;j<=5;j++){var desk_append="";var desk=eval("HROS.VAR.desk"+j);if(desk!=""){$(desk).each(function(){desk_append+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid==0?this.appid:this.realappid,imgsrc:this.icon,appsize:HROS.CONFIG.appSize})})}desk_append+=addbtnTemp({appsize:HROS.CONFIG.appSize});$("#desk-"+j+" .desktop-apps-container .appbtn").remove();$("#desk-"+j+" .desktop-apps-container").append(desk_append)}HROS.app.setPos(false);$("body .quick_view_container").each(function(){HROS.folderView.get($("#d_"+$(this).attr("appid")))});$("#desk .folder-window").each(function(){HROS.window.updateFolder($(this).attr("appid"))});HROS.app.getScrollbar()},setPos:function(e){$("#desk .desktop-container .appbtn img").width(HROS.CONFIG.appSize).height(HROS.CONFIG.appSize);$("#desk .desktop-container .appbtn span").width(Number(HROS.CONFIG.appSize)+10);e=e==null?true:e;var t=HROS.grid.getAppGrid(),i=HROS.grid.getDockAppGrid();$("#dock-bar .dock-applist .appbtn").each(function(e){$(this).css({top:HROS.CONFIG.dockPos=="top"?i[e]["startY"]:i[e]["startY"]+5,left:HROS.CONFIG.dockPos=="top"?i[e]["startX"]+5:i[e]["startX"]}).attr("top",$(this).offset().top).attr("left",$(this).offset().left)});for(var a=1;a<=5;a++){$("#desk-"+a+" .appbtn").each(function(i){var a=HROS.CONFIG.appVerticalSpacing/2;var s=HROS.CONFIG.appHorizontalSpacing/2;var o=t[i]["startY"]+a;var n=t[i]["startX"]+s;$(this).stop(true,false).animate({top:o,left:n},e?500:0);switch(HROS.CONFIG.dockPos){case"top":$(this).attr("left",n).attr("top",o+$("#dock-bar").height());break;case"left":$(this).attr("left",n+$("#dock-bar").width()).attr("top",o);break;default:$(this).attr("left",n).attr("top",o)}})}HROS.app.getScrollbar()},add:function(e,t){function i(){t&&t()}if(HROS.base.checkLogin()){$.ajax({data:"ac=addMyApp&id="+e+"&desk="+HROS.CONFIG.desk}).done(function(e){i()})}else{i()}},remove:function(e,t){function i(){HROS.widget.removeCookie(e);t&&t()}if(HROS.base.checkLogin()){$.ajax({data:"ac=delMyApp&id="+e}).done(function(e){i()})}else{i()}},move:function(){$("#dock-bar .dock-applist").on("mousedown",".appbtn",function(e){e.preventDefault();e.stopPropagation();if(e.which==1){var t=$(this);var i=$('<div id="shortcut_shadow">'+t.html()+"</div>");var a=e.clientX;var s=e.clientY;var o=e.clientX;var n=e.clientY;var r=a-t.offset().left;var p=s-t.offset().top;var d=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(i);d.show();o=e.clientX<=0?0:e.clientX>=$(window).width()?$(window).width():e.clientX;n=e.clientY<=0?0:e.clientY>=$(window).height()?$(window).height():e.clientY;if(a!=o||s!=n){i.css({left:o-r,top:n-p}).show()}}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");i.remove();d.hide();if(a==o&&s==n){switch(t.attr("type")){case"window":case"pwindow":case"file":HROS.window.create(t.attr("appid"),t.attr("type"));break;case"widget":case"pwidget":HROS.widget.create(t.attr("appid"),t.attr("type"));break;case"folder":HROS.folderView.get(t);break}return false}var e=HROS.grid.searchFolderGrid(o,n);if(e!=null){if(t.hasClass("folder")==false){var r=t.attr("appid");var p=t.index();var l=e;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDockToFolder(r,p,l)){$.ajax({data:"ac=moveMyApp&movetype=dock-folder&id="+r+"&from="+p+"&to="+l}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDockToFolder(r,p,l)}}}else{var c=HROS.CONFIG.dockPos=="left"?0:HROS.CONFIG.dockPos=="top"?($(window).width()-$("#dock-container").width()+20)/2:$(window).width()-$("#dock-container").width();var f=HROS.CONFIG.dockPos=="top"?0:($(window).height()-$("#dock-container").height()+20)/2;var e=HROS.grid.searchDockAppGrid(o-c,n-f);if(e!=null){if(e!=t.index()){var h=HROS.grid.searchDockAppGrid2(o-c,n-f);var r=t.attr("appid");var p=t.index();var l=e;var u=h%2==0?"b":"a";if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDockToDock(r,p,l,u)){$.ajax({data:"ac=moveMyApp&movetype=dock-dock&id="+r+"&from="+p+"&to="+l+"&boa="+u}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDockToDock(r,p,l,u)}}}else{var c=HROS.CONFIG.dockPos=="left"?$("#dock-bar").width():0;var f=HROS.CONFIG.dockPos=="top"?$("#dock-bar").height():0;var w=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollLeft();var m=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollTop();var e=HROS.grid.searchAppGrid(o-c+w,n-f+m);if(e!=null){var h=HROS.grid.searchAppGrid2(o-c+w,n-f+m);var r=t.attr("appid");var p=t.index();var l=e;var u=h%2==0?"b":"a";var k=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDockToDesk(r,p,l,u,k)){$.ajax({data:"ac=moveMyApp&movetype=dock-desk&id="+r+"&from="+p+"&to="+l+"&boa="+u+"&desk="+k}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDockToDesk(r,p,l,u,k)}}}}})}});$("#desktop .desktop-apps-container").on("mousedown",".appbtn",function(e){e.preventDefault();e.stopPropagation();if(e.which==1&&!$(this).hasClass("add")){var t=$(this);var i=$('<div id="shortcut_shadow">'+t.html()+"</div>");var a=e.clientX;var s=e.clientY;var o=e.clientX;var n=e.clientY;var r=a-t.offset().left;var p=s-t.offset().top;var d=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(i);d.show();o=e.clientX<=0?0:e.clientX>=$(window).width()?$(window).width():e.clientX;n=e.clientY<=0?0:e.clientY>=$(window).height()?$(window).height():e.clientY;if(a!=o||s!=n){i.css({left:o-r,top:n-p}).show()}}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");i.remove();d.hide();if(a==o&&s==n){switch(t.attr("type")){case"window":case"pwindow":case"file":HROS.window.create(t.attr("appid"),t.attr("type"));break;case"widget":case"pwidget":HROS.widget.create(t.attr("appid"),t.attr("type"));break;case"folder":HROS.folderView.get(t);break}return false}var e=HROS.grid.searchFolderGrid(o,n);if(e!=null){if(t.attr("type")!="folder"){var r=t.attr("appid");var p=t.index();var l=e;var c=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToFolder(r,p,l,c)){$.ajax({data:"ac=moveMyApp&movetype=desk-folder&id="+r+"&from="+p+"&to="+l+"&desk="+c}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToFolder(r,p,l,c)}}}else{var f=HROS.CONFIG.dockPos=="left"?0:HROS.CONFIG.dockPos=="top"?($(window).width()-$("#dock-container").width()+20)/2:$(window).width()-$("#dock-container").width();var h=HROS.CONFIG.dockPos=="top"?0:($(window).height()-$("#dock-container").height()+20)/2;var e=HROS.grid.searchDockAppGrid(o-f,n-h);if(e!=null){var u=HROS.grid.searchDockAppGrid2(o-f,n-h);var r=t.attr("appid");var p=t.index();var l=e;var w=u%2==0?"b":"a";var c=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToDock(r,p,l,w,c)){$.ajax({data:"ac=moveMyApp&movetype=desk-dock&id="+r+"&from="+p+"&to="+l+"&boa="+w+"&desk="+c}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToDock(r,p,l,w,c)}}else{var f=HROS.CONFIG.dockPos=="left"?$("#dock-bar").width():0;var h=HROS.CONFIG.dockPos=="top"?$("#dock-bar").height():0;var m=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollLeft();var k=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollTop();var e=HROS.grid.searchAppGrid(o-f+m,n-h+k);if(e!=null&&e!=t.index()){var u=HROS.grid.searchAppGrid2(o-f+m,n-h+k);var r=t.attr("appid");var p=t.index();var l=e;var w=u%2==0?"b":"a";var c=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToDesk(r,p,l,w,c)){$.ajax({data:"ac=moveMyApp&movetype=desk-desk&id="+r+"&from="+p+"&to="+l+"&boa="+w+"&desk="+c}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToDesk(r,p,l,w,c)}}}}})}});$("body").on("mousedown",".folder_body .appbtn, .quick_view_container .appbtn",function(e){e.preventDefault();e.stopPropagation();if(e.which==1){var t=$(this);var i=$('<div id="shortcut_shadow">'+t.html()+"</div>");var a=e.clientX;var s=e.clientY;var o=e.clientX;var n=e.clientY;var r=a-t.offset().left;var p=s-t.offset().top;var d=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(i);d.show();o=e.clientX<=0?0:e.clientX>=$(window).width()?$(window).width():e.clientX;n=e.clientY<=0?0:e.clientY>=$(window).height()?$(window).height():e.clientY;if(a!=o||s!=n){i.css({left:o-r,top:n-p}).show()}}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");i.remove();d.hide();if(a==o&&s==n){switch(t.attr("type")){case"window":case"pwindow":case"file":HROS.window.create(t.attr("appid"),t.attr("type"));break;case"widget":case"pwidget":HROS.widget.create(t.attr("appid"),t.attr("type"));break}return false}var e=HROS.grid.searchFolderGrid(o,n);if(e!=null){if((t.parents(".folder-window").attr("appid")||t.parents(".quick_view_container").attr("appid"))!=e){var r=t.attr("appid");var p=t.index();var l=e;var c=t.parents(".folder-window").attr("appid")||t.parents(".quick_view_container").attr("appid");if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataFolderToFolder(r,p,l,c)){$.ajax({data:"ac=moveMyApp&movetype=folder-folder&id="+r+"&from="+p+"&to="+l}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataFolderToFolder(r,p,l,c)}}}else{var f=HROS.CONFIG.dockPos=="left"?0:HROS.CONFIG.dockPos=="top"?($(window).width()-$("#dock-container").width()+20)/2:$(window).width()-$("#dock-container").width();var h=HROS.CONFIG.dockPos=="top"?0:($(window).height()-$("#dock-container").height()+20)/2;var e=HROS.grid.searchDockAppGrid(o-f,n-h);if(e!=null){var u=HROS.grid.searchDockAppGrid2(o-f,n-h);var r=t.attr("appid");var p=t.index();var l=e;var c=t.parents(".folder-window").attr("appid")||t.parents(".quick_view_container").attr("appid");var w=u%2==0?"b":"a";var m=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataFolderToDock(r,p,l,c,w,m)){$.ajax({data:"ac=moveMyApp&movetype=folder-dock&id="+r+"&to="+l+"&boa="+w+"&desk="+m}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataFolderToDock(r,p,l,c,w,m)}}else{var f=HROS.CONFIG.dockPos=="left"?$("#dock-bar").width():0;var h=HROS.CONFIG.dockPos=="top"?$("#dock-bar").height():0;var k=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollLeft();var v=$("#desk-"+HROS.CONFIG.desk+" .desktop-apps-container").scrollTop();var e=HROS.grid.searchAppGrid(o-f+k,n-h+v);if(e!=null){var u=HROS.grid.searchAppGrid2(o-f+k,n-h+v);var r=t.attr("appid");var p=t.index();var l=e;var c=t.parents(".folder-window").attr("appid")||t.parents(".quick_view_container").attr("appid");var w=u%2==0?"b":"a";var m=HROS.CONFIG.desk;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataFolderToDesk(r,p,l,c,w,m)){$.ajax({data:"ac=moveMyApp&movetype=folder-desk&id="+r+"&to="+l+"&boa="+w+"&desk="+m}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataFolderToDesk(r,p,l,c,w,m)}}}}})}})},getScrollbar:function(){setTimeout(function(){$("#desk .desktop-container").each(function(){var e=$(this).children(".desktop-apps-container"),t=$(this).children(".scrollbar");var i=e.nextAll(".scrollbar-x").position().left,a=e.nextAll(".scrollbar-y").position().top;t.hide();e.scrollLeft(0).scrollTop(0);if(HROS.CONFIG.appXY=="x"){var s=parseInt(e.children(".add").css("top"))+parseInt(e.children(".add").outerHeight());if(e.height()<s){e.nextAll(".scrollbar-y").height(e.height()/s*e.height());a=a+e.nextAll(".scrollbar-y").height()>e.height()?e.height()-e.nextAll(".scrollbar-y").height():a;e.nextAll(".scrollbar-y").css("top",a).show();e.scrollTop(a/e.height()*s)}}else{var o=parseInt(e.children(".add").css("left"))+parseInt(e.children(".add").outerWidth());if(e.width()<o){e.nextAll(".scrollbar-x").width(e.width()/o*e.width());i=i+e.nextAll(".scrollbar-x").width()>e.width()?e.width()-e.nextAll(".scrollbar-w").width():i;e.nextAll(".scrollbar-x").css("left",i).show();e.scrollLeft(i/e.width()*o)}}})},500)},moveScrollbar:function(){$("#desk .scrollbar").on("mousedown",function(e){var t,i,a,s,o,n,r,p;var d=$(this),l=d.prevAll(".desktop-apps-container");o=parseInt(l.children(".add").css("left"))+parseInt(l.children(".add").outerWidth());n=parseInt(l.children(".add").css("top"))+parseInt(l.children(".add").outerHeight());r=l.width()-d.width();p=l.height()-d.height();if(d.hasClass("scrollbar-x")){t=e.clientX-d.position().left}else{i=e.clientY-d.position().top}$(document).on("mousemove",function(e){if(d.hasClass("scrollbar-x")){a=e.clientX-t<0?0:e.clientX-t>r?r:e.clientX-t;d.css("left",a);l.scrollLeft(a/l.width()*o)}else{s=e.clientY-i<0?0:e.clientY-i>p?p:e.clientY-i;d.css("top",s);l.scrollTop(s/l.height()*n)}}).on("mouseup",function(){$(this).off("mousemove").off("mouseup")})});for(var e=1;e<=5;e++){$("#desk-"+e).on("mousewheel",function(e,t){var i=$(this).find(".desktop-apps-container");if(HROS.CONFIG.appXY=="x"){var a=parseInt(i.find(".add").css("top"))+parseInt(i.children(".add").outerHeight()),s;if(t<0){s=i.scrollTop()+200>a-i.height()?a-i.height():i.scrollTop()+200}else{s=i.scrollTop()-200<0?0:i.scrollTop()-200}i.stop(false,true).animate({scrollTop:s},300);i.nextAll(".scrollbar-y").stop(false,true).animate({top:s/a*i.height()},300)}else{var o=parseInt(i.find(".add").css("left"))+parseInt(i.children(".add").outerWidth()),n;if(t<0){n=i.scrollLeft()+200>o-i.width()?o-i.width():i.scrollLeft()+200}else{n=i.scrollLeft()-200<0?0:i.scrollLeft()-200}i.stop(false,true).animate({scrollLeft:n},300);i.nextAll(".scrollbar-x").stop(false,true).animate({left:n/o*i.width()},300)}})}},checkIsMoving:function(){var e=false;if(HROS.VAR.isAppMoving){swal({type:"warning",title:"温馨提示",text:"数据正在处理中，请稍后…",timer:2e3,showConfirmButton:false});e=true}else{HROS.VAR.isAppMoving=true}return e},dataWarning:function(){swal({type:"error",title:"温馨提示",text:"数据错误，请刷新后重试",timer:2e3,showConfirmButton:false})},dataDockToFolder:function(e,t,i){var a=false;$(HROS.VAR.dock).each(function(t){if(this.appid==e){$(HROS.VAR.folder).each(function(e){if(this.appid==i){HROS.VAR.folder[e].apps.push(HROS.VAR.dock[t]);HROS.VAR.folder[e].apps=HROS.VAR.folder[e].apps.sortBy(function(e){return e.appid},true);HROS.VAR.dock.splice(t,1);a=true;return false}});return false}});if(a){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return a},dataDockToDock:function(e,t,i,a){var s=false;if(HROS.VAR.dock[t]!=null){if(i==0){if(a=="b"){HROS.VAR.dock.splice(0,0,HROS.VAR.dock[t])}else{HROS.VAR.dock.splice(1,0,HROS.VAR.dock[t])}}else{if(a=="b"){HROS.VAR.dock.splice(i,0,HROS.VAR.dock[t])}else{HROS.VAR.dock.splice(i+1,0,HROS.VAR.dock[t])}}if(t>i){HROS.VAR.dock.splice(t+1,1)}else{HROS.VAR.dock.splice(t,1)}s=true}if(s){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return s},dataDockToDesk:function(id,from,to,boa,desk){var rtn=false;desk=eval("HROS.VAR.desk"+desk);if(HROS.VAR.dock[from]!=null){if(to==0){if(boa=="b"){desk.splice(0,0,HROS.VAR.dock[from])}else{desk.splice(1,0,HROS.VAR.dock[from])}}else{if(boa=="b"){desk.splice(to,0,HROS.VAR.dock[from])}else{desk.splice(to+1,0,HROS.VAR.dock[from])}}HROS.VAR.dock.splice(from,1);rtn=true}if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataDockToOtherdesk:function(id,from,todesk){var rtn=false;todesk=eval("HROS.VAR.desk"+todesk);if(HROS.VAR.dock[from]!=null){todesk.push(HROS.VAR.dock[from]);HROS.VAR.dock.splice(from,1);rtn=true}if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataDockToDelete:function(e,t){var i=false;if(HROS.VAR.dock[t]!=null){HROS.VAR.dock.splice(t,1);i=true}if(i){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return i},dataDeskToFolder:function(id,from,to,desk){var rtn=false;desk=eval("HROS.VAR.desk"+desk);$(HROS.VAR.folder).each(function(e){if(this.appid==to&&desk[from]!=null){HROS.VAR.folder[e].apps.push(desk[from]);HROS.VAR.folder[e].apps=HROS.VAR.folder[e].apps.sortBy(function(e){return e.appid},true);desk.splice(from,1);rtn=true;return false}});if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataDeskToDock:function(id,from,to,boa,desk){var rtn=false;desk=eval("HROS.VAR.desk"+desk);if(desk[from]!=null){if(to==0){if(boa=="b"){HROS.VAR.dock.splice(0,0,desk[from])}else{HROS.VAR.dock.splice(1,0,desk[from])}}else{if(boa=="b"){HROS.VAR.dock.splice(to,0,desk[from])}else{HROS.VAR.dock.splice(to+1,0,desk[from])}}desk.splice(from,1);if(HROS.VAR.dock.length>7){desk.push(HROS.VAR.dock[7]);HROS.VAR.dock.splice(7,1)}rtn=true}if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataDeskToDesk:function(id,from,to,boa,desk){var rtn=false;desk=eval("HROS.VAR.desk"+desk);if(desk[from]!=null){if(to==0){if(boa=="b"){desk.splice(0,0,desk[from])}else{desk.splice(1,0,desk[from])}}else{if(boa=="b"){desk.splice(to,0,desk[from])}else{desk.splice(to+1,0,desk[from])}}if(from>to){desk.splice(from+1,1)}else{desk.splice(from,1)}rtn=true}if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataDeskToOtherdesk:function(id,from,to,boa,todesk,fromdesk){var rtn=false;fromdesk=eval("HROS.VAR.desk"+fromdesk);todesk=eval("HROS.VAR.desk"+todesk);if(fromdesk[from]!=null){if(to==0){if(boa=="b"){todesk.splice(0,0,fromdesk[from])}else{todesk.splice(1,0,fromdesk[from])}}else{if(boa=="b"){todesk.splice(to,0,fromdesk[from])}else{todesk.splice(to+1,0,fromdesk[from])}}fromdesk.splice(from,1);rtn=true}if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataFolderToFolder:function(e,t,i,a){var s=false,o=0,n,r;$(HROS.VAR.folder).each(function(e){if(this.appid==a&&HROS.VAR.folder[e].apps[t]!=null){n=e;o+=1}if(this.appid==i){r=e;o+=1}});if(o==2){HROS.VAR.folder[r].apps.push(HROS.VAR.folder[n].apps[t]);HROS.VAR.folder[r].apps=HROS.VAR.folder[r].apps.sortBy(function(e){return e.appid},true);HROS.VAR.folder[n].apps.splice(t,1);s=true}if(s){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return s},dataFolderToDock:function(id,from,to,fromFolderId,boa,desk){
var rtn=false;desk=eval("HROS.VAR.desk"+desk);$(HROS.VAR.folder).each(function(e){if(this.appid==fromFolderId&&HROS.VAR.folder[e].apps[from]!=null){if(to==0){if(boa=="b"){HROS.VAR.dock.splice(0,0,HROS.VAR.folder[e].apps[from])}else{HROS.VAR.dock.splice(1,0,HROS.VAR.folder[e].apps[from])}}else{if(boa=="b"){HROS.VAR.dock.splice(to,0,HROS.VAR.folder[e].apps[from])}else{HROS.VAR.dock.splice(to+1,0,HROS.VAR.folder[e].apps[from])}}HROS.VAR.folder[e].apps.splice(from,1);if(HROS.VAR.dock.length>7){desk.push(HROS.VAR.dock[7]);HROS.VAR.dock.splice(7,1)}rtn=true;return false}});if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataFolderToDesk:function(id,from,to,fromFolderId,boa,desk){var rtn=false;desk=eval("HROS.VAR.desk"+desk);$(HROS.VAR.folder).each(function(e){if(this.appid==fromFolderId&&HROS.VAR.folder[e].apps[from]!=null){if(to==0){if(boa=="b"){desk.splice(0,0,HROS.VAR.folder[e].apps[from])}else{desk.splice(1,0,HROS.VAR.folder[e].apps[from])}}else{if(boa=="b"){desk.splice(to,0,HROS.VAR.folder[e].apps[from])}else{desk.splice(to+1,0,HROS.VAR.folder[e].apps[from])}}HROS.VAR.folder[e].apps.splice(from,1);rtn=true;return false}});if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataFolderToOtherdesk:function(id,from,todesk,fromFolderId){var rtn=false;todesk=eval("HROS.VAR.desk"+todesk);$(HROS.VAR.folder).each(function(e){if(this.appid==fromFolderId&&HROS.VAR.folder[e].apps[from]!=null){todesk.push(HROS.VAR.folder[e].apps[from]);HROS.VAR.folder[e].apps.splice(from,1);rtn=true;return false}});if(rtn){if($("#desktop").is(":visible")){HROS.app.set()}else{HROS.appmanage.set()}}else{HROS.app.dataWarning()}return rtn},dataAllDockToDesk:function(desk){desk=eval("HROS.VAR.desk"+desk);$(HROS.VAR.dock).each(function(e){desk.push(HROS.VAR.dock[e])});HROS.VAR.dock.splice(0,HROS.VAR.dock.length)},dataDeleteByAppid:function(appid){$(HROS.VAR.dock).each(function(e){if(this.appid==appid){HROS.VAR.dock.splice(e,1);return false}});for(var i=1;i<=5;i++){var desk=eval("HROS.VAR.desk"+i);$(desk).each(function(e){if(this.appid==appid){desk.splice(e,1);if(this.type=="folder"){$(HROS.VAR.folder).each(function(e){if(this.appid==appid){HROS.VAR.folder.splice(e,1);return false}})}return false}})}$(HROS.VAR.folder).each(function(e){$(this.apps).each(function(t){if(this.appid==appid){HROS.VAR.folder[e].apps.splice(t,1);return false}})})}}}();HROS.appmanage=function(){return{init:function(){$("#appmanage .amg_close").off("click").on("click",function(){HROS.appmanage.close()});$("#amg_dock_container, #amg_folder_container").on("contextmenu",".appbtn",function(){return false});HROS.appmanage.move();HROS.appmanage.moveScrollbar()},set:function(){$("#desktop").hide();$("#appmanage").show();$("#amg_folder_container .folderItem").show().addClass("folderItem_turn");$("#amg_folder_container .folderInner").height($(window).height()-80);var dock_append="";if(HROS.VAR.dock!=""){$(HROS.VAR.dock).each(function(e){dock_append+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid==0?this.appid:this.realappid,imgsrc:this.icon,appsize:48})})}$("#amg_dock_container .appbtn").remove();$("#amg_dock_container").append(dock_append);for(var j=0;j<5;j++){var desk_append="",desk=eval("HROS.VAR.desk"+(j+1));if(desk!=""){$(desk).each(function(e){desk_append+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid==0?this.appid:this.realappid,imgsrc:this.icon,appsize:26})})}$("#amg_folder_container .folderItem:eq("+j+") .folderInner .appbtn").remove();$("#amg_folder_container .folderItem:eq("+j+") .folderInner").append(desk_append)}HROS.appmanage.setPos();HROS.appmanage.getScrollbar()},setPos:function(){var e=HROS.grid.getManageDockAppGrid(),t=HROS.grid.getManageAppGrid();$("#amg_dock_container .appbtn").each(function(t){$(this).css({top:10,left:e[t]["startX"]+6})});for(var i=0;i<5;i++){$("#amg_folder_container .folderItem:eq("+i+") .folderInner .appbtn").each(function(e){$(this).css({top:t[e]["startY"]+5,left:0})})}},move:function(){$("#amg_dock_container").on("mousedown",".appbtn",function(e){e.preventDefault();e.stopPropagation();if(e.which==1){var t=$(this);var i=$('<div id="shortcut_shadow">'+t.html()+"</div>");var a=e.clientX;var s=e.clientY;var o=e.clientX;var n=e.clientY;var r=a-t.offset().left;var p=s-t.offset().top;var d=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(i);d.show();o=e.clientX<=0?0:e.clientX>=$(window).width()?$(window).width():e.clientX;n=e.clientY<=0?0:e.clientY>=$(window).height()?$(window).height():e.clientY;if(a!=o||s!=n){i.css({left:o-r,top:n-p}).show()}}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");i.remove();d.hide();if(a==o&&s==n){HROS.appmanage.close();switch(t.attr("type")){case"widget":case"pwidget":HROS.widget.create(t.attr("appid"),t.attr("type"));break;case"window":case"pwindow":case"folder":HROS.window.create(t.attr("appid"),t.attr("type"));break}return false}if(n<=80){var e=HROS.grid.searchManageDockAppGrid(o);if(e!=null&&e!=t.index()){var r=HROS.grid.searchManageDockAppGrid2(o);var p=t.attr("appid");var l=t.index();var c=e;var f=r%2==0?"b":"a";if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDockToDock(p,l,c,f)){$.ajax({data:"ac=moveMyApp&movetype=dock-dock&id="+p+"&from="+l+"&to="+c+"&boa="+f}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDockToDock(p,l,c,f)}}}else{var h=parseInt(o/($(window).width()/5));var e=HROS.grid.searchManageAppGrid(n-80+$("#amg_folder_container .folderItem:eq("+h+") .folderInner").scrollTop());if(e!=null){var r=HROS.grid.searchManageAppGrid2(n-80+$("#amg_folder_container .folderItem:eq("+h+") .folderInner").scrollTop());var p=t.attr("appid");var l=t.index();var c=e;var f=r%2==0?"b":"a";var u=h+1;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDockToDesk(p,l,c,f,u)){$.ajax({data:"ac=moveMyApp&movetype=dock-desk&id="+p+"&from="+l+"&to="+c+"&boa="+f+"&desk="+u}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDockToDesk(p,l,c,f,u)}}}})}return false});$("#amg_folder_container").on("mousedown",".appbtn:not(.add)",function(e){e.preventDefault();e.stopPropagation();if(e.which==1){var t=$(this);var i=$('<div id="shortcut_shadow2">'+t.html()+"</div>");var a=e.clientX;var s=e.clientY;var o=e.clientX;var n=e.clientY;var r=a-t.offset().left;var p=s-t.offset().top;var d=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(i);d.show();o=e.clientX<=0?0:e.clientX>=$(window).width()?$(window).width():e.clientX;n=e.clientY<=0?0:e.clientY>=$(window).height()?$(window).height():e.clientY;if(a!=o||s!=n){i.css({left:o-r,top:n-p}).show()}}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");i.remove();d.hide();if(a==o&&s==n){HROS.appmanage.close();switch(t.attr("type")){case"widget":case"pwidget":HROS.widget.create(t.attr("appid"),t.attr("type"));break;case"window":case"pwindow":case"folder":HROS.window.create(t.attr("appid"),t.attr("type"));break}return false}if(n<=80){function e(){var e=HROS.grid.searchManageDockAppGrid(o);if(e!=null){var i=HROS.grid.searchManageDockAppGrid2(o);var a=t.attr("appid");var s=t.index();var n=e;var r=i%2==0?"b":"a";var p=t.parent().attr("desk");if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToDock(a,s,n,r,p)){$.ajax({data:"ac=moveMyApp&movetype=desk-dock&id="+a+"&from="+s+"&to="+n+"&boa="+r+"&desk="+p}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToDock(a,s,n,r,p)}}}if(HROS.CONFIG.dockPos=="none"){swal({type:"warning",title:"温馨提示",text:"当前应用码头处于停用状态，是否开启？",showCancelButton:true,confirmButtonText:"是的",cancelButtonText:"不用"},function(){HROS.dock.updatePos("top");e()})}else{e()}}else{var r=parseInt(o/($(window).width()/5));var p=HROS.grid.searchManageAppGrid(n-80+$("#amg_folder_container .folderItem:eq("+r+") .folderInner").scrollTop());if(r+1==t.parent().attr("desk")){if(p!=null&&p!=t.index()){var l=HROS.grid.searchManageAppGrid2(n-80+$("#amg_folder_container .folderItem:eq("+r+") .folderInner").scrollTop());var c=t.attr("appid");var f=t.index();var h=p;var u=l%2==0?"b":"a";var w=r+1;if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToDesk(c,f,h,u,w)){$.ajax({data:"ac=moveMyApp&movetype=desk-desk&id="+c+"&from="+f+"&to="+h+"&boa="+u+"&desk="+w}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToDesk(c,f,h,u,w)}}}else{if(p!=null){var l=HROS.grid.searchManageAppGrid2(n-80+$("#amg_folder_container .folderItem:eq("+r+") .folderInner").scrollTop());var c=t.attr("appid");var f=t.index();var h=p;var u=l%2==0?"b":"a";var m=r+1;var k=t.parent().attr("desk");if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){if(HROS.app.dataDeskToOtherdesk(c,f,h,u,m,k)){$.ajax({data:"ac=moveMyApp&movetype=desk-otherdesk&id="+c+"&from="+f+"&to="+h+"&boa="+u+"&fromdesk="+k+"&todesk="+m}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{HROS.app.dataDeskToOtherdesk(c,f,h,u,m,k)}}}}})}return false})},getScrollbar:function(){$("#amg_folder_container .folderInner").height($(window).height()-80);$("#amg_folder_container .folderItem").each(function(){var e=$(this).find(".folderInner"),t=parseInt(e.children(".appbtn:last").css("top"))+41,i=e.next(".scrollBar");var a=i.position().top;i.hide();e.scrollTop(0);if(e.height()/t<1){i.height(e.height()/t*e.height());a=a+i.height()>e.height()?e.height()-i.height():a;i.css("top",a).show();e.scrollTop(a/e.height()*t)}})},moveScrollbar:function(){$(".scrollBar").on("mousedown",function(e){var t,i,a,s;var o=$(this),n=o.prev(".folderInner");a=parseInt(n.children(".appbtn:last").css("top"))+41;s=n.height()-o.height();t=e.clientY-o.offset().top;$(document).on("mousemove",function(e){i=e.clientY-t-80<0?0:e.clientY-t-80>s?s:e.clientY-t-80;o.css("top",i);n.scrollTop(i/n.height()*a)}).on("mouseup",function(){$(this).off("mousemove").off("mouseup")})});$("#amg_folder_container .folderInner").on("mousewheel",function(e,t){var i=$(this),a=parseInt(i.children(".appbtn:last").css("top"))+41,s;if(t<0){s=i.scrollTop()+120>a-i.height()?a-i.height():i.scrollTop()+120}else{s=i.scrollTop()-120<0?0:i.scrollTop()-120}i.stop(false,true).animate({scrollTop:s},300);i.next(".scrollBar").stop(false,true).animate({top:s/a*i.height()},300)})},resize:function(){HROS.appmanage.getScrollbar()},close:function(){$("#amg_dock_container").html("");$("#amg_folder_container .folderInner").html("");$("#desktop").show();$("#appmanage").hide();$("#amg_folder_container .folderItem").removeClass("folderItem_turn");HROS.app.set();HROS.deskTop.resize()}}}();HROS.base=function(){return{init:function(){$.ajaxSetup({url:ajaxUrl,type:"POST",dataType:"json"});$(document).ajaxSuccess(function(e,t,i){if($.trim(t.responseText)=="ERROR_NOT_LOGGED_IN"&&HROS.CONFIG.memberID!=0){HROS.base.loginDialog()}});HROS.CONFIG.memberID=Cookies.get(cookie_prefix+"memberID");$("body").on("contextmenu",function(){return false});HROS.copyright.init();HROS.zoom.init();HROS.deskTop.init();HROS.wallpaper.init();HROS.searchBar.init();HROS.startMenu.init();HROS.taskBar.init();HROS.dock.init();HROS.app.init();HROS.widget.init();HROS.window.init();HROS.folderView.init();HROS.appmanage.init();HROS.popupMenu.init();HROS.lock.init();HROS.hotkey.init();HROS.base.run()},loginDialog:function(e){e=typeof e==="undefined"?"系统检测到您尚未登录，或者长时间未操作已登出<br>为了更好的操作，是否登录？":e;HROS.CONFIG.memberID=0;swal({type:"warning",title:"温馨提示",text:e,html:true,showCancelButton:true,confirmButtonText:"走，去登录！",cancelButtonText:"我再逛逛…"},function(){HROS.base.login()})},login:function(){$("#lrbox").animate({top:0},500,function(){changeTabindex()})},logout:function(){$.ajax({url:"login.ajax.php",data:"ac=logout"}).done(function(){location.reload()})},checkLogin:function(){return HROS.CONFIG.memberID!=0?true:false},setSkin:function(e,t){$("#window-skin").attr("id","window-skin-ready2remove");var i=loadCSS("static/img/skins/"+e+".css?"+version);onloadCSS(i,function(){$("body link").last().attr("id","window-skin");$("#window-skin-ready2remove").remove();HROS.CONFIG.skin=e;t&&t()})},run:function(){var e=location.search;var t=new Object;if(e.indexOf("?")!=-1){var i=e.substr(1);strs=i.split("&");for(var a=0;a<strs.length;a++){t[strs[a].split("=")[0]]=unescape(strs[a].split("=")[1])}}if(typeof t["run"]!="undefined"&&typeof t["type"]!="undefined"){if(HROS.base.checkLogin()){$.ajax({data:"ac=getAppidByRealappid&id="+t["run"]}).done(function(e){if(t["type"]=="app"){HROS.window.create(e)}else{if(!HROS.widget.checkCookie(e,t["type"])){HROS.widget.create(e)}}})}else{HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php?id="+t["run"],width:800,height:484,isflash:false,refresh:true})}}}}}();HROS.copyright=function(){return{init:function(){$("#copyright .close").on("click",function(){HROS.copyright.hide()})},show:function(){var e=HROS.maskBox.copyright();e.show();$("#copyright").show()},hide:function(){var e=HROS.maskBox.copyright();e.hide();$("#copyright").hide()}}}();HROS.deskTop=function(){return{init:function(){$(window).on("resize",function(){HROS.deskTop.resize()});$("body").on("click","#desktop",function(){HROS.popupMenu.hide();HROS.folderView.hide();HROS.searchBar.hide();HROS.startMenu.hide()}).on("contextmenu","#desktop",function(e){HROS.popupMenu.hide();HROS.folderView.hide();HROS.searchBar.hide();HROS.startMenu.hide();var t=HROS.popupMenu.desk();var i=$(window).width()-e.clientX<t.width()?e.clientX-t.width():e.clientX;var a=$(window).height()-e.clientY<t.height()?e.clientY-t.height():e.clientY;t.css({left:i,top:a}).show();return false})},resize:function(){if($("#desktop").is(":visible")){HROS.dock.setPos();HROS.app.setPos();HROS.window.setPos();HROS.folderView.setPos()}else{HROS.appmanage.resize()}HROS.wallpaper.set(false)},updateDefaultDesk:function(e){if(HROS.base.checkLogin()){$.ajax({data:"ac=setDesk&desk="+e})}}}}();HROS.dock=function(){return{init:function(){HROS.dock.setPos();HROS.dock.move();var e;$("#dock-container").on("mouseenter",function(){e=setTimeout(function(){$("#dock-container").addClass("showtop")},300)}).on("mouseleave",function(){clearInterval(e);$(this).removeClass("showtop")});$("body").on("contextmenu","#dock-container",function(e){HROS.popupMenu.hide();HROS.folderView.hide();HROS.searchBar.hide();HROS.startMenu.hide();var t=HROS.popupMenu.dock();var i=$(window).width()-e.clientX<t.width()?e.clientX-t.width():e.clientX;var a=$(window).height()-e.clientY<t.height()?e.clientY-t.height():e.clientY;t.css({left:i,top:a}).show();return false});$("#dock-bar .dock-tool-setting").on("mousedown",function(){return false}).on("click",function(){if(HROS.base.checkLogin()){HROS.window.createTemp({appid:"hoorayos-zmsz",title:"桌面设置",url:"sysapp/desksetting/index.php",width:750,height:450,isflash:false})}else{HROS.base.login()}});$("#dock-bar .dock-tool-style").on("mousedown",function(){return false}).on("click",function(){if(HROS.base.checkLogin()){HROS.window.createTemp({appid:"hoorayos-ztsz",title:"主题设置",url:"sysapp/wallpaper/index.php",width:580,height:520,isflash:false})}else{HROS.base.login()}});$("#dock-bar .dock-tool-appmanage").on("mousedown",function(){return false}).on("click",function(){HROS.appmanage.set()});$("#dock-bar .dock-tool-search").on("mousedown",function(e){return false}).on("click",function(e){e.stopPropagation();HROS.searchBar.get()});$("#dock-bar .pagination").on("mousedown",function(){return false}).on("click",function(){HROS.dock.switchDesk($(this).attr("index"))});$("#dock-bar .dock-tool-start").on("mousedown",function(){return false}).on("click",function(){HROS.startMenu.show();return false})},setPos:function(){HROS.dock.switchDesk(HROS.CONFIG.desk);var e=$("#desk-"+HROS.CONFIG.desk),t=$("#desk .desktop-container");var i=e.css("width","100%").width(),a=e.css("height","100%").height();$("#dock-container").removeClass("dock-top dock-left dock-right");$("#dock-bar").removeClass("top-bar left-bar right-bar").hide();if(HROS.CONFIG.dockPos=="top"){$("#dock-bar").addClass("top-bar").children("#dock-container").addClass("dock-top");t.css({width:i,height:a-$("#task-bar").height()-$("#dock-bar").height(),left:i,top:$("#dock-bar").height()});e.css({left:0});$("#dock-bar").show()}else if(HROS.CONFIG.dockPos=="left"){$("#dock-bar").addClass("left-bar").children("#dock-container").addClass("dock-left");t.css({width:i-$("#dock-bar").width(),height:a-$("#task-bar").height(),left:i+$("#dock-bar").width(),top:0});e.css({left:$("#dock-bar").width()});$("#dock-bar").show()}else if(HROS.CONFIG.dockPos=="right"){$("#dock-bar").addClass("right-bar").children("#dock-container").addClass("dock-right");t.css({width:i-$("#dock-bar").width(),height:a-$("#task-bar").height(),left:i,top:0});e.css({left:0});$("#dock-bar").show()}else if(HROS.CONFIG.dockPos=="none"){t.css({width:i,height:a-$("#task-bar").height(),left:i,top:0});e.css({left:0})}HROS.taskBar.resize();HROS.folderView.setPos()},updatePos:function(e){if(e!=HROS.CONFIG.dockPos&&typeof e!="undefined"){HROS.CONFIG.dockPos=e;if(e=="none"){HROS.app.dataAllDockToDesk(HROS.CONFIG.desk)}HROS.dock.setPos();HROS.app.set();if(HROS.base.checkLogin()){$.ajax({data:"ac=setDockPos&dock="+e+"&desk="+HROS.CONFIG.desk})}}},move:function(){$("#dock-container").on("mousedown",function(e){if(e.which==1){var t=HROS.maskBox.dock(),i;$(document).on("mousemove",function(e){t.show();if(e.clientY<t.height()*.2){i="top"}else if(e.clientX<t.width()*.5){i="left"}else{i="right"}$(".dock_drap_effect").removeClass("hover");$(".dock_drap_effect_"+i).addClass("hover")}).on("mouseup",function(){$(document).off("mousemove").off("mouseup");t.hide();HROS.dock.updatePos(i)})}})},switchDesk:function(e){e=/^\+?[1-5]*$/.test(e)?e:1;var t=$("#dock-bar .dock-pagination"),i=HROS.CONFIG.desk,a=e,s=$("#desk-"+i).offset().left,o=$("#desk-"+a).offset().left;if(i!=a){if(!$("#desk-"+a).hasClass("animated")&&!$("#desk-"+i).hasClass("animated")){$("#desk-"+i).addClass("animated").animate({left:o},500,"easeInOutCirc",function(){$(this).removeClass("animated")});$("#desk-"+a).addClass("animated").animate({left:s},500,"easeInOutCirc",function(){$(this).removeClass("animated");t.removeClass("current-pagination-"+i).addClass("current-pagination-"+a);HROS.CONFIG.desk=a})}}else{t.removeClass("current-pagination-"+i).addClass("current-pagination-"+a)}}}}();HROS.folderView=function(){return{init:function(){$("body").on("click",".quick_view_container",function(){HROS.popupMenu.hide()}).on("click",".quick_view_container_open",function(){HROS.window.create($(this).parents(".quick_view_container").attr("appid"),"folder");HROS.folderView.hide()}).on("click",".appbtn",function(){HROS.popupMenu.hide();HROS.folderView.hide();HROS.searchBar.hide();HROS.startMenu.hide()});HROS.folderView.moveScrollbar()},get:function(e){setTimeout(function(){var t=false;$("body .quick_view_container").each(function(){if($(this).attr("realappid")==e.attr("realappid")){t=true;return false}});if(t){var i="#qv_"+e.attr("appid")}else{HROS.folderView.hide()}var a="";$(HROS.VAR.folder).each(function(){if(this.appid==e.attr("appid")){a=this.apps;return false}});var s="",o=0;if(a!=""){$(a).each(function(){s+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid,imgsrc:this.icon})});if(a.length%4==0){o+=Math.floor(a.length/4)*60}else{o+=(Math.floor(a.length/4)+1)*60}}else{s="文件夹为空";o+=30}var n,r;if(e.parent("div").hasClass("dock-applist")){n=parseInt(e.attr("left"))+e.width();r=parseInt(e.attr("top"))}else{n=parseInt(e.attr("left"))+e.width();r=parseInt(e.attr("top"))-20}var p=false;if(o+r+44>$(window).height()){var d=o+r+44-$(window).height();if(d<=r){r-=d}else{o-=d-r;r=0;p=true}}if(n+330>$(window).width()){n-=330+e.width();if(t){$(i+" .quick_view_container_list_in").html("").append(s);$(i).stop(true,false).animate({left:n,top:r},500);$(i+" .perfect_nine_m_l_t").stop(true,false).animate({top:0,height:Math.ceil((o+24)/2)},200);$(i+" .perfect_nine_m_l_m").stop(true,false).animate({top:Math.ceil((o+24)/2)},200).hide();$(i+" .perfect_nine_m_l_b").stop(true,false).animate({top:Math.ceil((o+24)/2),height:Math.ceil((o+24)/2)+20},200);$(i+" .perfect_nine_m_r_t").stop(true,false).animate({top:0,height:e.offset().top-r},200);$(i+" .perfect_nine_m_r_m").stop(true,false).animate({top:parseInt(e.attr("top"))-r},200).show();$(i+" .perfect_nine_m_r_b").stop(true,false).animate({top:parseInt(e.attr("top"))-r+20,height:o+24-(parseInt(e.attr("top"))-r)-20+20},200);$(i+" .quick_view_container_list_in").stop(true,false).animate({height:o},200)}else{$("body").append(folderViewTemp({id:"qv_"+e.attr("appid"),appid:e.attr("appid"),realappid:e.attr("realappid"),apps:s,top:r,left:n,height:o,mlt:Math.ceil((o+24)/2),mlm:false,mlb:Math.ceil((o+24)/2),mrt:e.offset().top-r,mrm:true,mrb:o+24-(e.offset().top-r)-20}))}}else{if(t){$(i+" .quick_view_container_list_in").html("").append(s);$(i).stop(true,false).animate({left:n,top:r},500);$(i+" .perfect_nine_m_l_t").stop(true,false).animate({top:0,height:parseInt(e.attr("top"))-r},200);$(i+" .perfect_nine_m_l_m").stop(true,false).animate({top:parseInt(e.attr("top"))-r},200).show();$(i+" .perfect_nine_m_l_b").stop(true,false).animate({top:parseInt(e.attr("top"))-r+20,height:o+24-(parseInt(e.attr("top"))-r)-20},200);$(i+" .perfect_nine_m_r_t").stop(true,false).animate({top:0,height:Math.ceil((o+24)/2)},200);$(i+" .perfect_nine_m_r_m").stop(true,false).animate({top:Math.ceil((o+24)/2)},200).hide();$(i+" .perfect_nine_m_r_b").stop(true,false).animate({top:Math.ceil((o+24)/2),height:Math.ceil((o+24)/2)},200);$(i+" .quick_view_container_list_in").stop(true,false).animate({height:o},200)}else{$("body").append(folderViewTemp({id:"qv_"+e.attr("appid"),appid:e.attr("appid"),realappid:e.attr("realappid"),apps:s,top:r,left:n,height:o,mlt:e.offset().top-r,mlm:true,mlb:o+24-(e.offset().top-r)-20,mrt:Math.ceil((o+24)/2),mrm:false,mrb:Math.ceil((o+24)/2)}))}}var l="#quick_view_container_list_in_"+e.attr("appid");var c="#quick_view_container_list_"+e.attr("appid")+" .scrollBar";$("#quick_view_container_list_"+e.attr("appid")+" .scrollBar_bgc").hide();$(c).hide().height(0);if(p){$("#quick_view_container_list_"+e.attr("appid")+" .scrollBar_bgc").show();$(c).show().height($(l).height()/(Math.ceil($(l).children().length/4)*60)*$(l).height())}},0)},setPos:function(){$("body .quick_view_container").each(function(){HROS.folderView.get($("#d_"+$(this).attr("appid")))})},moveScrollbar:function(){$("body").on("mousedown",".quick_view_container .quick_view_container_list .scrollBar",function(e){var t=$(this),i=t.prev(".quick_view_container_list_in");var a=i.offset().top;var s,o,n,r;n=Math.ceil(i.children().length/4)*60;r=i.height()-t.height();s=e.clientY-t.offset().top;$(document).on("mousemove",function(e){o=e.clientY-s-a<0?0:e.clientY-s-a>r?r:e.clientY-s-a;t.css("top",o);i.scrollTop(o/i.height()*n)}).on("mouseup",function(){$(this).off("mousemove").off("mouseup")})});$("body").on("mousewheel",".quick_view_container_list_in",function(e,t){var i=$(this),a=Math.ceil($(this).children().length/4)*60,s;if(t<0){s=i.scrollTop()+40>a-i.height()?a-i.height():i.scrollTop()+40}else{s=i.scrollTop()-40<0?0:i.scrollTop()-40}i.stop(false,true).animate({scrollTop:s},300);$(this).next(".scrollBar").stop(false,true).animate({top:s/a*i.height()},300)})},hide:function(){$(".quick_view_container").remove()}}}();HROS.grid=function(){return{getAppGrid:function(){var e=$("#desk-"+HROS.CONFIG.desk).width()-HROS.CONFIG.appMarginLeft;var t=$("#desk-"+HROS.CONFIG.desk).height()-HROS.CONFIG.appMarginTop;var i=HROS.CONFIG.appMarginTop;var a=HROS.CONFIG.appMarginLeft;var s=[];var o=$("#desk-1 .add").outerHeight()+HROS.CONFIG.appVerticalSpacing;var n=$("#desk-1 .add").outerWidth()+HROS.CONFIG.appHorizontalSpacing;for(var r=0;r<500;r++){s.push({startY:i,endY:i+o,startX:a,endX:a+n});if(HROS.CONFIG.appXY=="x"){a+=n;if(a+n>e){i+=o;a=HROS.CONFIG.appMarginLeft}}else{i+=o;if(i+o>t){i=HROS.CONFIG.appMarginTop;a+=n}}}return s},searchAppGrid:function(e,t){var i=HROS.grid.getAppGrid();var a=null;for(var s=0;s<i.length;s++){if(e>=i[s].startX&&e<=i[s].endX&&t>=i[s].startY&&t<=i[s].endY){a=s;break}}return a},searchAppGrid2:function(e,t){var i=HROS.grid.getAppGrid();var a=[];for(var s=0;s<i.length;s++){var o=i[s].endY-i[s].startY;var n=i[s].endX-i[s].startX;var r=o/2;var p=n/2;if(HROS.CONFIG.appXY=="x"){a.push({startY:i[s].startY,endY:i[s].startY+o,startX:i[s].startX,endX:i[s].startX+p},{startY:i[s].startY,endY:i[s].startY+o,startX:i[s].startX+p,endX:i[s].endX})}else{a.push({startY:i[s].startY,endY:i[s].startY+r,startX:i[s].startX,endX:i[s].startX+n},{startY:i[s].startY+r,endY:i[s].endY,startX:i[s].startX,endX:i[s].startX+n})}}var d=null;for(var s=0;s<a.length;s++){if(e>=a[s].startX&&e<=a[s].endX&&t>=a[s].startY&&t<=a[s].endY){d=s;break}}return d},getDockAppGrid:function(){var e=$("#dock-bar .dock-applist").height();var t=[];var i=0;var a=0;var s=68;var o=68;for(var n=0;n<7;n++){t.push({startY:i,endY:i+s,startX:a,endX:a+o});i+=s;if(i+s>e){i=0;a+=o}}return t},searchDockAppGrid:function(e,t){var i=HROS.grid.getDockAppGrid();var a=null;for(var s=0;s<i.length;s++){if(e>=i[s].startX&&e<=i[s].endX&&t>=i[s].startY&&t<=i[s].endY){a=s;break}}return a},searchDockAppGrid2:function(e,t){var i=HROS.grid.getDockAppGrid();var a=[];for(var s=0;s<i.length;s++){var o=i[s].endY-i[s].startY;var n=i[s].endX-i[s].startX;var r=o/2;var p=n/2;if(HROS.CONFIG.dockPos=="top"){a.push({startY:i[s].startY,endY:i[s].startY+o,startX:i[s].startX,endX:i[s].startX+p},{startY:i[s].startY,endY:i[s].startY+o,startX:i[s].startX+p,endX:i[s].endX})}else{a.push({startY:i[s].startY,endY:i[s].startY+r,startX:i[s].startX,endX:i[s].startX+n},{startY:i[s].startY+r,endY:i[s].endY,startX:i[s].startX,endX:i[s].startX+n})}}var d=null;for(var s=0;s<a.length;s++){if(e>=a[s].startX&&e<=a[s].endX&&t>=a[s].startY&&t<=a[s].endY){d=s;break}}return d},getFolderGrid:function(){var e=[];$(".quick_view_container, .folder-window:visible").each(function(){e.push({zIndex:$(this).css("z-index"),id:$(this).attr("appid"),startY:$(this).offset().top,endY:$(this).offset().top+$(this).height(),startX:$(this).offset().left,endX:$(this).offset().left+$(this).width()})});e.sort(function(e,t){return t["zIndex"]-e["zIndex"]});return e},searchFolderGrid:function(e,t){var i=HROS.grid.getFolderGrid();var a=null;for(var s=0;s<i.length;s++){if(e>=i[s].startX&&e<=i[s].endX&&t>=i[s].startY&&t<=i[s].endY){a=i[s]["id"];break}}return a},getManageDockAppGrid:function(){var e=[];var t=20;for(var i=0;i<50;i++){e.push({startX:t,endX:t+70});t+=70}return e},searchManageDockAppGrid:function(e){var t=HROS.grid.getManageDockAppGrid();var i=null;for(var a=0;a<t.length;a++){if(e>=t[a].startX&&e<=t[a].endX){i=a;break}}return i},searchManageDockAppGrid2:function(e){var t=HROS.grid.getManageDockAppGrid();var i=[];for(var a=0;a<t.length;a++){var s=t[a].endX-t[a].startX;var o=s/2;i.push({startX:t[a].startX,endX:t[a].startX+o},{startX:t[a].startX+o,endX:t[a].endX})}var n=null;for(var a=0;a<i.length;a++){if(e>=i[a].startX&&e<=i[a].endX){n=a;break}}return n},getManageAppGrid:function(){var e=[];var t=0;for(var i=0;i<500;i++){e.push({startY:t,endY:t+40});t+=40}return e},searchManageAppGrid:function(e){var t=HROS.grid.getManageAppGrid();var i=null;for(var a=0;a<t.length;a++){if(e>=t[a].startY&&e<=t[a].endY){i=a;break}}return i},searchManageAppGrid2:function(e){var t=HROS.grid.getManageAppGrid();var i=[];for(var a=0;a<t.length;a++){var s=t[a].endY-t[a].startY;var o=t[a].endX-t[a].startX;var n=s/2;i.push({startY:t[a].startY,endY:t[a].startY+n},{startY:t[a].startY+n,endY:t[a].endY})}var r=null;for(var a=0;a<i.length;a++){if(e>=i[a].startY&&e<=i[a].endY){r=a;break}}return r}}}();HROS.hotkey=function(){return{init:function(){Mousetrap.bind(["backspace"],function(){return false});Mousetrap.bind(["alt+d"],function(){HROS.window.hideAll();return false});Mousetrap.bind(["ctrl+up","command+up"],function(){HROS.appmanage.set();return false});Mousetrap.bind(["ctrl+f","command+f"],function(){HROS.searchBar.get();return false});Mousetrap.bind(["ctrl+1","command+1"],function(){HROS.dock.switchDesk(1);return false});Mousetrap.bind(["ctrl+2","command+2"],function(){HROS.dock.switchDesk(2);return false});Mousetrap.bind(["ctrl+3","command+3"],function(){HROS.dock.switchDesk(3);return false});Mousetrap.bind(["ctrl+4","command+4"],function(){HROS.dock.switchDesk(4);return false});Mousetrap.bind(["ctrl+5","command+5"],function(){HROS.dock.switchDesk(5);return false});Mousetrap.bind(["ctrl+left","command+left"],function(){if(parseInt(HROS.CONFIG.desk)-1<1){HROS.dock.switchDesk(5)}else{HROS.dock.switchDesk(parseInt(HROS.CONFIG.desk)-1)}return false});Mousetrap.bind(["ctrl+right","command+right"],function(){if(parseInt(HROS.CONFIG.desk)+1>5){HROS.dock.switchDesk(1)}else{HROS.dock.switchDesk(parseInt(HROS.CONFIG.desk)+1)}return false});Mousetrap.bind(["ctrl+l","command+l"],function(){HROS.lock.show();return false})}}}();HROS.lock=function(){return{init:function(){Mousetrap.bind(["space"],function(){$("#lock").click();return false});$("body").on("click","#lock",function(){if($("#lock-info").is(":visible")){$("#lock .title").animate({top:"10%"},500);$("#lock .tip").animate({top:"80%"},500);$("#lock-info").fadeOut();Mousetrap.bind(["space"],function(){$("#lock").click();return false});Mousetrap.unbind("esc")}else{$("#lock .title").animate({top:"-200px"},500);$("#lock .tip").animate({top:"100%"},500);$("#lock-info").fadeIn();$("#lockpassword").val("").focus();$("#lock-info .text-tip").text("");Mousetrap.bind(["esc"],function(){$("#lock").click();return false});Mousetrap.unbind("space")}});$("body").on("click","#lock-info",function(){return false});$("body").on("click","#lockbtn",function(){if($("#lockpassword").val()!=""){$.ajax({url:"login.ajax.php",data:"ac=unlock&password="+$("#lockpassword").val()}).done(function(e){if(e=="ERROR_LOCKPASSWORD"){$("#lockpassword").val("").focus();$("#lock-info .text-tip").text("解锁密码错误")}else{HROS.lock.hide()}})}else{$("#lock-info .text-tip").text("请输入解锁密码")}});$("body").on("keydown","#lockpassword",function(e){if(e.keyCode=="13"){$("#lockbtn").click()}})},show:function(){if($("#lock").length==0){if(!HROS.base.checkLogin()){HROS.base.loginDialog("锁定功能需要登录后才能使用，为了更好的操作，是否登录？")}else{var e=function(){$.ajax({url:"login.ajax.php",data:"ac=logout"});$("#desktop").hide();var e=Cookies.get(cookie_prefix+"userinfo");if(typeof e!=="undefined"){e=JSON.parse(e);$("body").append(lockTemp({avatar:e.avatar,username:e.username}))}var t=function(){var e=new Date;$("#lock .time").text((e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()));var t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"，星期";switch(e.getDay()){case"1":t+="一";break;case"1":t+="二";break;case"1":t+="三";break;case"1":t+="四";break;case"1":t+="五";break;case"1":t+="六";break;default:t+="日"}$("#lock .week").text(t)};t();lockFunc=setInterval(function(){var e=false;if($("#desktop").is(":visible")){e=true}if($("#lock").length==0){e=true}if($("#lock").is(":hidden")){e=true}if(e){clearInterval(lockFunc);$("#lock").remove();HROS.lock.show()}t()},1e3)};if(Cookies.get(cookie_prefix+"isfirstlock"+HROS.CONFIG.memberID)==null){Cookies.set(cookie_prefix+"isfirstlock"+HROS.CONFIG.memberID,1);swal({type:"warning",title:"温馨提示",text:"解锁密码默认为登录密码，是否要先进行修改？",showCancelButton:true,confirmButtonText:"继续锁定",cancelButtonText:"修改解锁密码"},function(t){if(t){e()}else{HROS.window.createTemp({appid:"zhsz",title:"账号设置",url:"sysapp/account/security.php",width:550,height:580})}})}else{e()}}}},hide:function(){clearInterval(lockFunc);$("#lock").remove();$("#desktop").show()}}}();HROS.maskBox=function(){return{desk:function(){if(!TEMP.maskBoxDesk){TEMP.maskBoxDesk=$('<div id="maskbox"></div>');$("body").append(TEMP.maskBoxDesk)}return TEMP.maskBoxDesk},dock:function(){if(!TEMP.maskBoxDock){TEMP.maskBoxDock=$('<div id="maskbox-dockdrap"><div id="docktop" class="dock_drap_effect dock_drap_effect_top"></div><div id="dockleft" class="dock_drap_effect dock_drap_effect_left"></div><div id="dockright" class="dock_drap_effect dock_drap_effect_right"></div><div id="dockmask" class="dock_drap_mask"><div class="dock_drop_region_top"><div class="text">拖放至顶部</div></div><div class="dock_drop_region_left"><div class="text">拖放至左侧</div></div><div class="dock_drop_region_right"><div class="text">拖放至右侧</div></div></div></div>');
$("body").append(TEMP.maskBoxDock)}return TEMP.maskBoxDock},copyright:function(){if(!TEMP.maskBoxCopyright){TEMP.maskBoxCopyright=$('<div id="maskbox-copyright"></div>');$("body").append(TEMP.maskBoxCopyright)}return TEMP.maskBoxCopyright}}}();HROS.popupMenu=function(){return{init:function(){$(".popup-menu").on("contextmenu",function(){return false});$("body").on("mouseenter",".popup-menu li",function(){if($(this).children(".popup-menu").length==1){$(this).children("a").addClass("focus");$(this).children(".popup-menu").show();if($(this).parents(".popup-menu").offset().left+$(this).parents(".popup-menu").outerWidth()*2+10<$(window).width()){$(this).children(".popup-menu").css({left:$(this).parents(".popup-menu").outerWidth()-2,top:0})}else{$(this).children(".popup-menu").css({left:$(this).parents(".popup-menu").outerWidth()*-1,top:0})}if($(this).children(".popup-menu").offset().top+$(this).children(".popup-menu").height()+10>$(window).height()){$(this).children(".popup-menu").css({top:$(window).height()-$(this).children(".popup-menu").height()-$(this).children(".popup-menu").offset().top-10})}}}).on("mouseleave",".popup-menu li",function(){$(this).children("a").removeClass("focus");$(this).children(".popup-menu").hide()})},app:function(e){HROS.window.show2under();if(!TEMP.popupMenuApp){TEMP.popupMenuApp=$('<div class="popup-menu app-menu"><ul>'+'<li><a menu="open" href="javascript:;"><i class="fa fa-fw fa-external-link"></i>打开</a></li>'+'<li class="separator"></li>'+"<li>"+'<a menu="move" href="javascript:;"><i class="fa fa-fw fa-share"></i>移动到<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="moveto" desk="1" href="javascript:;"><i class="fa fa-fw fa-check"></i>桌面1</a></li>'+'<li><a menu="moveto" desk="2" href="javascript:;"><i class="fa fa-fw fa-check"></i>桌面2</a></li>'+'<li><a menu="moveto" desk="3" href="javascript:;"><i class="fa fa-fw fa-check"></i>桌面3</a></li>'+'<li><a menu="moveto" desk="4" href="javascript:;"><i class="fa fa-fw fa-check"></i>桌面4</a></li>'+'<li><a menu="moveto" desk="5" href="javascript:;"><i class="fa fa-fw fa-check"></i>桌面5</a></li>'+"</ul></div>"+"</li>"+'<li><a menu="edit" href="javascript:;"><i class="fa fa-fw fa-pencil"></i>编辑</a></li>'+'<li><a menu="del" href="javascript:;"><i class="fa fa-fw fa-trash"></i>卸载</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuApp)}$('.app-menu a[menu="moveto"]').removeClass("disabled").children("i.fa-check").hide();if(e.parent().hasClass("desktop-apps-container")){$('.app-menu a[menu="moveto"]').each(function(){if($(this).attr("desk")==HROS.CONFIG.desk){$(this).addClass("disabled").children("i.fa-check").show()}})}$('.app-menu a[menu="moveto"]:not(.disabled)').off("click").on("click",function(){var t=e.attr("appid"),i=e.index(),a=99999,s=$(this).attr("desk"),o=HROS.CONFIG.desk,n=e.parents(".folder-window").attr("appid")||e.parents(".quick_view_container").attr("appid");if(HROS.base.checkLogin()){if(!HROS.app.checkIsMoving()){var r=false;if(e.parent().hasClass("dock-applist")){if(HROS.app.dataDockToOtherdesk(t,i,s)){$.ajax({data:"ac=moveMyApp&movetype=dock-otherdesk&id="+t+"&from="+i+"&todesk="+s}).done(function(e){HROS.VAR.isAppMoving=false})}}else if(e.parent().hasClass("desktop-apps-container")){if(HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)){$.ajax({data:"ac=moveMyApp&movetype=desk-otherdesk&id="+t+"&from="+i+"&to="+a+"&todesk="+s+"&fromdesk="+o}).done(function(e){HROS.VAR.isAppMoving=false})}}else{if(HROS.app.dataFolderToOtherdesk(t,i,s,n)){$.ajax({data:"ac=moveMyApp&movetype=folder-otherdesk&id="+t+"&from="+i+"&todesk="+s+"&fromfolderid="+n}).done(function(e){HROS.VAR.isAppMoving=false})}}}}else{if(e.parent().hasClass("dock-applist")){HROS.app.dataDockToOtherdesk(t,i,s)}else if(e.parent().hasClass("desktop-apps-container")){HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)}else{HROS.app.dataFolderToOtherdesk(t,i,s,n)}}$(".popup-menu").hide()});$('.app-menu a[menu="open"]').off("click").on("click",function(){switch(e.attr("type")){case"window":HROS.window.create(e.attr("appid"),e.attr("type"));break;case"widget":HROS.widget.create(e.attr("appid"),e.attr("type"));break}$(".popup-menu").hide()});$('.app-menu a[menu="edit"]').off("click").on("click",function(){if(HROS.base.checkLogin()){dialog({id:"editdialog",title:"编辑应用“"+e.children("span").text()+"”",url:"sysapp/dialog/app.php?id="+e.attr("appid"),padding:0,width:770,height:450}).showModal()}else{HROS.base.login()}$(".popup-menu").hide()});$('.app-menu a[menu="del"]').off("click").on("click",function(){HROS.app.dataDeleteByAppid(e.attr("appid"));HROS.widget.removeCookie(e.attr("realappid"),e.attr("type"));HROS.app.remove(e.attr("appid"),function(){e.find("img, span").show().animate({opacity:"toggle",width:0,height:0},500,function(){e.remove();HROS.deskTop.resize()})});$(".popup-menu").hide()});return TEMP.popupMenuApp},papp:function(e){HROS.window.show2under();if(!TEMP.popupMenuPapp){TEMP.popupMenuPapp=$('<div class="popup-menu papp-menu"><ul>'+'<li><a menu="open" href="javascript:;"><i class="fa fa-fw fa-external-link"></i>打开</a></li>'+'<li class="separator"></li>'+"<li>"+'<a menu="move" href="javascript:;"><i class="fa fa-fw fa-share"></i>移动到<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="moveto" desk="1" href="javascript:;">桌面1</a></li>'+'<li><a menu="moveto" desk="2" href="javascript:;">桌面2</a></li>'+'<li><a menu="moveto" desk="3" href="javascript:;">桌面3</a></li>'+'<li><a menu="moveto" desk="4" href="javascript:;">桌面4</a></li>'+'<li><a menu="moveto" desk="5" href="javascript:;">桌面5</a></li>'+"</ul></div>"+"</li>"+'<li><a menu="edit" href="javascript:;"><i class="fa fa-fw fa-pencil"></i>编辑</a></li>'+'<li><a menu="del" href="javascript:;"><i class="fa fa-fw fa-trash"></i>删除</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuPapp)}$('.papp-menu a[menu="moveto"]').removeClass("disabled");if(e.parent().hasClass("desktop-apps-container")){$('.papp-menu a[menu="moveto"]').each(function(){if($(this).attr("desk")==HROS.CONFIG.desk){$(this).addClass("disabled")}})}$('.papp-menu a[menu="moveto"]:not(.disabled)').off("click").on("click",function(){var t=e.attr("appid"),i=e.index(),a=99999,s=$(this).attr("desk"),o=HROS.CONFIG.desk,n=e.parents(".folder-window").attr("appid")||e.parents(".quick_view_container").attr("appid");if(HROS.base.checkLogin()){var r=false;if(e.parent().hasClass("dock-applist")){if(HROS.app.dataDockToOtherdesk(t,i,s)){$.ajax({data:"ac=moveMyApp&movetype=dock-otherdesk&id="+t+"&from="+i+"&todesk="+s}).done(function(e){HROS.VAR.isAppMoving=false})}}else if(e.parent().hasClass("desktop-apps-container")){if(HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)){$.ajax({data:"ac=moveMyApp&movetype=desk-otherdesk&id="+t+"&from="+i+"&to="+a+"&todesk="+s+"&fromdesk="+o}).done(function(e){HROS.VAR.isAppMoving=false})}}else{if(HROS.app.dataFolderToOtherdesk(t,i,s,n)){$.ajax({data:"ac=moveMyApp&movetype=folder-otherdesk&id="+t+"&from="+i+"&todesk="+s+"&fromfolderid="+n}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{if(e.parent().hasClass("dock-applist")){HROS.app.dataDockToOtherdesk(t,i,s)}else if(e.parent().hasClass("desktop-apps-container")){HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)}else{HROS.app.dataFolderToOtherdesk(t,i,s,n)}}$(".popup-menu").hide()});$('.papp-menu a[menu="open"]').off("click").on("click",function(){switch(e.attr("type")){case"pwindow":HROS.window.create(e.attr("appid"),e.attr("type"));break;case"pwidget":HROS.widget.create(e.attr("appid"),e.attr("type"));break}$(".popup-menu").hide()});$('.papp-menu a[menu="edit"]').off("click").on("click",function(){if(HROS.base.checkLogin()){dialog({id:"editdialog",title:"编辑私人应用“"+e.children("span").text()+"”",url:"sysapp/dialog/papp.php?id="+e.attr("appid"),padding:0,width:770,height:450}).showModal()}else{HROS.base.login()}$(".popup-menu").hide()});$('.papp-menu a[menu="del"]').off("click").on("click",function(){HROS.app.dataDeleteByAppid(e.attr("appid"));HROS.widget.removeCookie(e.attr("realappid"),e.attr("type"));HROS.app.remove(e.attr("appid"),function(){e.find("img, span").show().animate({opacity:"toggle",width:0,height:0},500,function(){e.remove();HROS.deskTop.resize()})});$(".popup-menu").hide()});return TEMP.popupMenuPapp},folder:function(e){HROS.window.show2under();if(!TEMP.popupMenuFolder){TEMP.popupMenuFolder=$('<div class="popup-menu folder-menu"><ul>'+'<li><a menu="view" href="javascript:;"><i class="fa fa-fw fa-eye"></i>预览</a></li>'+'<li><a menu="open" href="javascript:;"><i class="fa fa-fw fa-folder-open-o"></i>打开</a></li>'+'<li class="separator"></li>'+"<li>"+'<a menu="move" href="javascript:;"><i class="fa fa-fw fa-share"></i>移动到<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="moveto" desk="1" href="javascript:;">桌面1</a></li>'+'<li><a menu="moveto" desk="2" href="javascript:;">桌面2</a></li>'+'<li><a menu="moveto" desk="3" href="javascript:;">桌面3</a></li>'+'<li><a menu="moveto" desk="4" href="javascript:;">桌面4</a></li>'+'<li><a menu="moveto" desk="5" href="javascript:;">桌面5</a></li>'+"</ul></div>"+"</li>"+'<li><a menu="rename" href="javascript:;"><i class="fa fa-fw fa-pencil"></i>重命名</a></li>'+'<li><a menu="del" href="javascript:;"><i class="fa fa-fw fa-trash"></i>删除</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuFolder)}$('.folder-menu a[menu="moveto"]').removeClass("disabled");if(e.parent().hasClass("desktop-apps-container")){$('.folder-menu a[menu="moveto"]').each(function(){if($(this).attr("desk")==HROS.CONFIG.desk){$(this).addClass("disabled")}})}$('.folder-menu a[menu="view"]').off("click").on("click",function(){HROS.folderView.get(e);$(".popup-menu").hide()});$('.folder-menu a[menu="open"]').off("click").on("click",function(){HROS.window.create(e.attr("appid"),e.attr("type"));$(".popup-menu").hide()});$('.folder-menu a[menu="moveto"]:not(.disabled)').off("click").on("click",function(){var t=e.attr("appid"),i=e.index(),a=99999,s=$(this).attr("desk"),o=HROS.CONFIG.desk,n=e.parents(".folder-window").attr("appid")||e.parents(".quick_view_container").attr("appid");if(HROS.base.checkLogin()){var r=false;if(e.parent().hasClass("dock-applist")){if(HROS.app.dataDockToOtherdesk(t,i,s)){$.ajax({data:"ac=moveMyApp&movetype=dock-otherdesk&id="+t+"&from="+i+"&todesk="+s}).done(function(e){HROS.VAR.isAppMoving=false})}}else if(e.parent().hasClass("desktop-apps-container")){if(HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)){$.ajax({data:"ac=moveMyApp&movetype=desk-otherdesk&id="+t+"&from="+i+"&to="+a+"&todesk="+s+"&fromdesk="+o}).done(function(e){HROS.VAR.isAppMoving=false})}}else{if(HROS.app.dataFolderToOtherdesk(t,i,s,n)){$.ajax({data:"ac=moveMyApp&movetype=folder-otherdesk&id="+t+"&from="+i+"&todesk="+s+"&fromfolderid="+n}).done(function(e){HROS.VAR.isAppMoving=false})}}}else{if(e.parent().hasClass("dock-applist")){HROS.app.dataDockToOtherdesk(t,i,s)}else if(e.parent().hasClass("desktop-apps-container")){HROS.app.dataDeskToOtherdesk(t,i,a,"a",s,o)}else{HROS.app.dataFolderToOtherdesk(t,i,s,n)}}$(".popup-menu").hide()});$('.folder-menu a[menu="rename"]').off("click").on("click",function(){if(HROS.base.checkLogin()){swal({type:"input",title:"重命名“"+e.find("span").text()+"”文件夹",showCancelButton:true,closeOnConfirm:false,confirmButtonText:"修改",cancelButtonText:"取消",animation:"slide-from-top",inputPlaceholder:"请输入文件夹名称",inputValue:e.find("span").text()},function(t){if(t===false){return false}if(t===""){swal.showInputError("文件夹名称不能为空");return false}$.ajax({data:"ac=updateFolder&name="+t+"&id="+e.attr("appid")}).done(function(e){HROS.app.get();swal({type:"success",title:"修改成功"})})})}else{HROS.base.login()}$(".popup-menu").hide()});$('.folder-menu a[menu="del"]').off("click").on("click",function(){swal({type:"warning",title:"删除“"+e.find("span").text()+"”文件夹",text:"删除文件夹的同时会删除文件夹内所有应用，确认要删除么？",showCancelButton:true,confirmButtonText:"确认删除",cancelButtonText:"我点错了"},function(){HROS.app.remove(e.attr("appid"),function(){HROS.app.dataDeleteByAppid(e.attr("appid"));e.find("img, span").show().animate({opacity:"toggle",width:0,height:0},500,function(){e.remove();HROS.deskTop.resize()})})});$(".popup-menu").hide()});return TEMP.popupMenuFolder},file:function(e){HROS.window.show2under();if(!TEMP.popupMenuFile){TEMP.popupMenuFile=$('<div class="popup-menu file-menu"><ul>'+'<li><a menu="download" href="javascript:;"><i class="fa fa-fw fa-cloud-download"></i>下载</a></li>'+'<li class="separator"></li>'+'<li><a menu="del" href="javascript:;"><i class="fa fa-fw fa-trash"></i>删除</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuFile)}$('.file-menu a[menu="download"]').off("click").on("click",function(){$("body").append(fileDownloadTemp({appid:e.attr("appid")}));$(".popup-menu").hide()});$('.file-menu a[menu="del"]').off("click").on("click",function(){HROS.app.dataDeleteByAppid(e.attr("appid"));HROS.app.remove(e.attr("appid"),function(){e.find("img, span").show().animate({opacity:"toggle",width:0,height:0},500,function(){e.remove();HROS.deskTop.resize()})});$(".popup-menu").hide()});return TEMP.popupMenuFile},dock:function(){HROS.window.show2under();if(!TEMP.popupMenuDock){TEMP.popupMenuDock=$('<div class="popup-menu dock-menu"><ul>'+'<li><a menu="dockPos" pos="top" href="javascript:;"><i class="fa fa-fw fa-check"></i>向上停靠</a></li>'+'<li><a menu="dockPos" pos="left" href="javascript:;"><i class="fa fa-fw fa-check"></i>向左停靠</a></li>'+'<li><a menu="dockPos" pos="right" href="javascript:;"><i class="fa fa-fw fa-check"></i>向右停靠</a></li>'+'<li class="separator"></li>'+'<li><a menu="dockPos" pos="none" href="javascript:;"><i class="fa fa-fw fa-eye-slash"></i>隐藏</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuDock);$('.dock-menu a[menu="dockPos"]').on("click",function(){if($(this).attr("pos")=="none"){if(Cookies.get(cookie_prefix+"isfirsthidedock"+HROS.CONFIG.memberID)==null){Cookies.set(cookie_prefix+"isfirsthidedock"+HROS.CONFIG.memberID,1);swal({type:"warning",title:"温馨提示",text:"如果应用码头存在应用，隐藏后会将应用转移到当前桌面<br>若需要再次开启，可在桌面空白处点击右键<br>进入「 桌面设置 」里开启",html:true,confirmButtonText:"我知道了"},function(){HROS.dock.updatePos("none")})}else{HROS.dock.updatePos("none")}}else{HROS.dock.updatePos($(this).attr("pos"))}$(".popup-menu").hide()})}$('.dock-menu a[menu="dockPos"]').each(function(){$(this).children("i.fa-check").hide();if($(this).attr("pos")==HROS.CONFIG.dockPos){$(this).children("i.fa-check").show()}$(".popup-menu").hide()});return TEMP.popupMenuDock},task:function(e){HROS.window.show2under();if(!TEMP.popupMenuTask){TEMP.popupMenuTask=$('<div class="popup-menu task-menu"><ul>'+'<li><a menu="show" href="javascript:;"><i class="fa fa-fw fa-caret-up"></i>还原</a></li>'+'<li><a menu="hide" href="javascript:;"><i class="fa fa-fw fa-caret-down"></i>最小化</a></li>'+'<li class="separator"></li>'+'<li><a menu="close" href="javascript:;"><i class="fa fa-fw fa-close"></i>关闭</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuTask)}if($("#w_"+e.attr("appid")).attr("state")=="hide"){$('.task-menu a[menu="show"]').parent().show();$('.task-menu a[menu="hide"]').parent().hide()}else{$('.task-menu a[menu="show"]').parent().hide();$('.task-menu a[menu="hide"]').parent().show()}$('.task-menu a[menu="show"]').off("click").on("click",function(){HROS.window.show2top(e.attr("appid"));$(".popup-menu").hide()});$('.task-menu a[menu="hide"]').off("click").on("click",function(){HROS.window.hide(e.attr("appid"));$(".popup-menu").hide()});$('.task-menu a[menu="close"]').off("click").on("click",function(){HROS.window.close(e.attr("appid"));$(".popup-menu").hide()});return TEMP.popupMenuTask},desk:function(){HROS.window.show2under();if(!TEMP.popupMenuDesk){TEMP.popupMenuDesk=$('<div class="popup-menu desk-menu"><ul>'+'<li><a menu="hideall" href="javascript:;"><i class="fa fa-fw fa-desktop"></i>显示桌面</a></li>'+'<li><a menu="closeall" href="javascript:;"><i class="fa fa-fw fa-close"></i>关闭所有窗口</a></li>'+'<li class="separator"></li>'+"<li>"+'<a href="javascript:;"><i class="fa fa-fw fa-folder-o"></i>新建<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="addfolder" href="javascript:;"><i class="fa fa-fw fa-folder-o"></i>新建文件夹</a></li>'+'<li><a menu="addpapp" href="javascript:;"><i class="fa fa-fw fa-edge"></i>新建私人应用</a></li>'+"</ul></div>"+"</li>"+'<li><a menu="uploadfile" href="javascript:;"><i class="fa fa-fw fa-cloud-upload"></i>上传文件</a></li>'+'<li class="separator"></li>'+'<li><a menu="themes" href="javascript:;"><i class="fa fa-fw fa-photo"></i>主题设置</a></li>'+'<li><a menu="setting" href="javascript:;"><i class="fa fa-fw fa-cog"></i>桌面设置</a></li>'+"<li>"+'<a href="javascript:;"><i class="fa fa-fw fa-th"></i>图标设置<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+"<li>"+'<a href="javascript:;"><i class="fa fa-fw fa-th"></i>排列<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="orderby" orderby="x" href="javascript:;"><i class="fa fa-fw fa-check"></i>横向排列</a></li>'+'<li><a menu="orderby" orderby="y" href="javascript:;"><i class="fa fa-fw fa-check"></i>纵向排列</a></li>'+"</ul></div>"+"</li>"+"<li>"+'<a href="javascript:;"><i class="fa fa-fw fa-square-o"></i>尺寸<i class="fa fa-caret-right arrow"></i></a>'+'<div class="popup-menu"><ul>'+'<li><a menu="size" size="32" href="javascript:;"><i class="fa fa-fw fa-check"></i>小图标</a></li>'+'<li><a menu="size" size="48" href="javascript:;"><i class="fa fa-fw fa-check"></i>常规图标</a></li>'+'<li><a menu="size" size="64" href="javascript:;"><i class="fa fa-fw fa-check"></i>大图标</a></li>'+"</ul></div>"+"</li>"+"</ul></div>"+"</li>"+'<li class="separator"></li>'+'<li><a menu="lock" href="javascript:;"><i class="fa fa-fw fa-lock"></i>锁定</a></li>'+'<li><a menu="logout" href="javascript:;"><i class="fa fa-fw fa-sign-out"></i>注销</a></li>'+"</ul></div>");$("body").append(TEMP.popupMenuDesk);if(!HROS.base.checkLogin()){$('body .desk-menu li a[menu="logout"]').parent().remove()}$('.desk-menu a[menu="orderby"]').on("click",function(){HROS.app.updateXY($(this).attr("orderby"));$(".popup-menu").hide()});$('.desk-menu a[menu="size"]').on("click",function(){HROS.app.updateSize($(this).attr("size"));$(".popup-menu").hide()});$('.desk-menu a[menu="hideall"]').on("click",function(){HROS.window.hideAll();$(".popup-menu").hide()});$('.desk-menu a[menu="closeall"]').on("click",function(){HROS.window.closeAll();$(".popup-menu").hide()});$('.desk-menu a[menu="addfolder"]').on("click",function(){if(HROS.base.checkLogin()){swal({type:"input",title:"新建文件夹",showCancelButton:true,closeOnConfirm:false,confirmButtonText:"创建",cancelButtonText:"取消",animation:"slide-from-top",inputPlaceholder:"请输入文件夹名称"},function(e){if(e===false){return false}if(e===""){swal.showInputError("文件夹名称不能为空");return false}$.ajax({data:"ac=addFolder&name="+e+"&desk="+HROS.CONFIG.desk}).done(function(e){HROS.app.get();swal({type:"success",title:"创建成功",timer:2e3,showConfirmButton:false})})})}else{HROS.base.login()}$(".popup-menu").hide()});$('.desk-menu a[menu="addpapp"]').on("click",function(){if(HROS.base.checkLogin()){dialog({id:"editdialog",title:"新建私人应用",url:"sysapp/dialog/papp.php?desk="+HROS.CONFIG.desk,padding:0,width:770,height:450}).showModal()}else{HROS.base.login()}$(".popup-menu").hide()});$('.desk-menu a[menu="uploadfile"]').on("click",function(){HROS.window.createTemp({appid:"hoorayos-scwj",title:"上传文件",url:"sysapp/upload/index.php",width:750,height:600,isflash:false});$(".popup-menu").hide()});$('.desk-menu a[menu="themes"]').on("click",function(){if(HROS.base.checkLogin()){HROS.window.createTemp({appid:"hoorayos-ztsz",title:"主题设置",url:"sysapp/wallpaper/index.php",width:580,height:520,isflash:false})}else{HROS.base.login()}$(".popup-menu").hide()});$('.desk-menu a[menu="setting"]').on("click",function(){if(HROS.base.checkLogin()){HROS.window.createTemp({appid:"hoorayos-zmsz",title:"桌面设置",url:"sysapp/desksetting/index.php",width:800,height:500,isflash:false})}else{HROS.base.login()}$(".popup-menu").hide()});$('.desk-menu a[menu="lock"]').on("click",function(){HROS.lock.show();$(".popup-menu").hide()});$('.desk-menu a[menu="logout"]').on("click",function(){HROS.base.logout();$(".popup-menu").hide()})}$('.desk-menu a[menu="orderby"]').each(function(){$(this).children(".fa-check").hide();if($(this).attr("orderby")==HROS.CONFIG.appXY){$(this).children(".fa-check").show()}$(".popup-menu").hide()});$('.desk-menu a[menu="size"]').each(function(){$(this).children(".fa-check").hide();if($(this).attr("size")==HROS.CONFIG.appSize){$(this).children(".fa-check").show()}$(".popup-menu").hide()});return TEMP.popupMenuDesk},hide:function(){$(".popup-menu").hide()}}}();HROS.searchBar=function(){return{init:function(){$("#pageletSearchInput").on("click",function(){return false});$("#search-suggest .resultBox").on("click","li",function(){switch($(this).attr("type")){case"window":HROS.window.create($(this).attr("appid"),$(this).attr("type"));break;case"widget":HROS.widget.create($(this).attr("appid"),$(this).attr("type"));break}});$("#search-suggest .openAppMarket a, #pageletSearchButton").on("click",function(){HROS.searchBar.openAppMarket($("#pageletSearchInput").val())});$("#pageletSearchInput").on("keydown",function(e){if(e.keyCode=="13"){if($("#search-suggest .resultBox .resultList a.selected").length==0&&$("#search-suggest > .resultList a.selected").length==0){HROS.searchBar.openAppMarket($(this).val())}else{$("#search-suggest .resultList a.selected").click()}}})},get:function(){var e="";searchFunc=setInterval(function(){var t=$("#pageletSearchInput").val();if(t!=""){$("#search-suggest").show();if(t!=e){e=t;HROS.searchBar.getSuggest(t)}$("#search-bar").removeClass("above").addClass("above")}else{$("#search-suggest").hide();$("#search-bar").removeClass("above")}},1e3);HROS.searchBar.set();Mousetrap.bind(["up"],function(){if($("#search-suggest .resultBox .resultList a.selected").length==0&&$("#search-suggest > .resultList a.selected").length==0){$("#search-suggest > .resultList:last a").addClass("selected")}else{if($("#search-suggest .resultBox .resultList:first a").hasClass("selected")){$("#search-suggest .resultList a").removeClass("selected")}else{if($("#search-suggest > .resultList a.selected").length!=0){var e=$("#search-suggest > .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected");if(e>1){$("#search-suggest > .resultList:eq("+(e-1)+") a").addClass("selected")}else{$("#search-suggest .resultBox .resultList:last a").addClass("selected")}}else{var e=$("#search-suggest .resultBox .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected");if(e>0){$("#search-suggest .resultBox .resultList:eq("+(e-1)+") a").addClass("selected")}}}}return false});Mousetrap.bind(["down"],function(){if($("#search-suggest .resultBox .resultList a.selected").length==0&&$("#search-suggest > .resultList a.selected").length==0){if($("#search-suggest .resultBox .resultList").length==0){$("#search-suggest > .resultList:first a").addClass("selected")}else{$("#search-suggest .resultBox .resultList:first a").addClass("selected")}}else{if($("#search-suggest > .resultList:last a").hasClass("selected")){$("#search-suggest .resultList a").removeClass("selected")}else{if($("#search-suggest .resultBox .resultList a.selected").length!=0){var e=$("#search-suggest .resultBox .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected");if(e<$("#search-suggest .resultBox .resultList").length-1){$("#search-suggest .resultBox .resultList:eq("+(e+1)+") a").addClass("selected")}else{$("#search-suggest > .resultList:first a").addClass("selected")}}else{var e=$("#search-suggest > .resultList a.selected").parent(".resultList").index();$("#search-suggest .resultList a").removeClass("selected");if(e<$("#search-suggest > .resultList").length-1){$("#search-suggest > .resultList:eq("+(e+1)+") a").addClass("selected")}else{$("#search-suggest .resultBox .resultList:first a").addClass("selected")}}}}return false});Mousetrap.bind(["backspace"],function(){})},set:function(){$("#search-bar").show();$("#search-suggest .resultList a").removeClass("selected");$("#pageletSearchInput").focus()},getSuggest:function(val){var apps=[];$(HROS.VAR.dock).each(function(){if($.inArray(this.type,["window","widget"])>=0){apps.push(this)}});for(var i=1;i<=5;i++){var desk=eval("HROS.VAR.desk"+i);$(desk).each(function(){if($.inArray(this.type,["window","widget"])>=0){apps.push(this)}})}$(HROS.VAR.folder).each(function(){$(this.apps).each(function(){if($.inArray(this.type,["window","widget"])>=0){apps.push(this)}})});var suggest="";$(apps).each(function(){if(this.name.indexOf(val)>=0){suggest+=suggestTemp({name:this.name,appid:this.appid,realappid:this.realappid,type:this.type})}});$("#search-suggest .resultBox").html(suggest);if(suggest==""){$("#search-suggest .resultBox").hide()}else{$("#search-suggest .resultBox").show()}HROS.searchBar.set()},openAppMarket:function(e){if(e!=""){HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php?searchkey="+e,width:800,height:484,isflash:false,refresh:true})}HROS.searchBar.hide()},hide:function(){if(typeof searchFunc!="undefined"){clearInterval(searchFunc)}$("#search-bar").removeClass("above");$("#search-bar, #search-suggest").hide();$("#pageletSearchInput").val("");$("#search-suggest .resultBox").html("");Mousetrap.unbind(["up","down"])}}}();HROS.startMenu=function(){return{init:function(){HROS.startMenu.getAvatar();$("#startmenu-container").on("mousedown",function(e){e.preventDefault()});$("#startmenu-container .startmenu-nick a, #startmenu-container .startmenu-avatar img").on("click",function(){HROS.startMenu.openAccount()});$("#startmenu-container .startmenu-exit a").on("click",function(){HROS.base.logout()});$("#startmenu-container .startmenu-lock").on("click",function(){HROS.lock.show()});$("#startmenu-container .startmenu-feedback").on("click",function(){HROS.window.createTemp({appid:"hoorayos-feedback",title:"反馈",url:"http://hoorayos.com/feedback.html",width:700,height:500,isflash:false})});$("#startmenu-container .startmenu a").on("click",function(){switch($(this).attr("class")){case"about":HROS.copyright.show();break}})},getAvatar:function(){$.ajax({data:"ac=getAvatar"}).done(function(e){$("#startmenu-container .startmenu-avatar img").attr("src",e["avatar"]+"?"+Date.parse(new Date))})},openAccount:function(){if(HROS.CONFIG.memberID!=0){HROS.window.createTemp({appid:"zhsz",title:"账号设置",url:"sysapp/account/index.php",width:780,height:580})}else{HROS.base.login()}},show:function(){HROS.popupMenu.hide();HROS.folderView.hide();HROS.searchBar.hide();$("#startmenu-container").css({top:"auto",left:"auto",right:"auto",bottom:"auto"}).show();switch(HROS.CONFIG.dockPos){case"top":$("#startmenu-container").css({top:$("#dock-container").height()-1,right:$("#dock-container").offset().left});break;case"left":$("#startmenu-container").css({bottom:$("#dock-container").offset().top,left:$("#dock-container").width()-1});break;case"right":$("#startmenu-container").css({bottom:$("#dock-container").offset().top,right:$("#dock-container").width()-1});break}},hide:function(){$("#startmenu-container").hide()}}}();HROS.taskBar=function(){return{init:function(){$(window).on("resize",function(){HROS.taskBar.resize()});HROS.taskBar.move();HROS.taskBar.pageClick();$("#task-content-inner").on("contextmenu",".task-item",function(e){$(".popup-menu").hide();$(".quick_view_container").remove();var t=HROS.popupMenu.task($(this));var i=$(window).width()-e.clientX<t.width()?e.clientX-t.width():e.clientX;var a=e.clientY-t.height();t.css({left:i,top:a}).show();return false})},pageClick:function(){$("#task-next-btn").on("click",function(){if($(this).hasClass("disable")==false){var e=$("#task-content-inner .task-item").width();var t=parseInt($("#task-content-inner").css("margin-left"))-e;var i=$("#task-bar").width()-$("#task-next").outerWidth(true)-$("#task-pre").outerWidth(true)-$("#task-content-inner .task-item").length*e;if(t<=i){t=i;$("#task-next a").addClass("disable")}$("#task-pre a").removeClass("disable");$("#task-content-inner").animate({marginLeft:t},200)}});$("#task-pre-btn").on("click",function(){if($(this).hasClass("disable")==false){var e=$("#task-content-inner .task-item").width();var t=parseInt($("#task-content-inner").css("margin-left"))+e;if(t>=0){t=0;$("#task-pre a").addClass("disable")}$("#task-next a").removeClass("disable");$("#task-content-inner").animate({marginLeft:t},200)}})},resize:function(){if(HROS.CONFIG.dockPos=="left"){$("#task-bar").css({left:$("#dock-bar").width(),right:0})}else if(HROS.CONFIG.dockPos=="right"){$("#task-bar").css({left:0,right:$("#dock-bar").width()})}else{$("#task-bar").css({left:0,right:0})}var e=$("#task-content-inner .task-item").length*$("#task-content-inner .task-item").width();var t=$("#task-bar").width()-$("#task-next").outerWidth(true)-$("#task-pre").outerWidth(true);if(e>=t){$("#task-next, #task-pre").show();$("#task-content").css("width",t);$("#task-content-inner").stop(true,false).animate({marginLeft:0},200);$("#task-next a").removeClass("disable");$("#task-pre a").addClass("disable")}else{$("#task-next, #task-pre").hide();$("#task-content").css("width","100%");$("#task-content-inner").css({marginLeft:0})}},move:function(){$("#task-content-inner").on("mousedown",".task-item",function(e){e.preventDefault();e.stopPropagation();if(e.which==1){var t=$(this);var i=t.offset().left;var a=t.width();var s=t.clone().addClass("task-dragging").css({left:i});var o;var n=e.clientX;var r=e.clientX;var p=HROS.maskBox.desk();$(document).on("mousemove",function(e){$("body").append(s);t.css("opacity",0);p.show();r=e.clientX;var o=r-n+i;s.css("left",o);$("#task-content-inner").find(".task-item").each(function(e){var i=$(this).offset().left;if(o>i&&o<i+a/2){if(t.attr("id")!=$(this).attr("id")){d($(this).attr("id"),"b")}}else if(o<i&&o>i-a/2){if(t.attr("id")!=$(this).attr("id")){d($(this).attr("id"),"a")}}})}).on("mouseup",function(e){$(document).off("mousemove").off("mouseup");p.hide();s.animate({left:t.offset().left},200,function(){$(this).remove();t.css("opacity",1)});if(n==r){if(t.hasClass("task-item-current")){HROS.window.hide(t.attr("appid"))}else{HROS.window.show2top(t.attr("appid"))}}});var d=function(e,i){if(!(t.is(":animated")&&o==e)){o=e;t.stop(true,true);$("#task-content-inner").find(".task-temp").remove();var s=t.clone().insertAfter(t).addClass("task-temp");if(i=="b"){$("#"+e).before(t.css({width:0}))}else{$("#"+e).after(t.css({width:0}))}t.animate({width:a},100);s.animate({width:0},100,function(){$(this).remove()})}}}})}}}();HROS.wallpaper=function(){return{init:function(){HROS.wallpaper.set()},get:function(e){$.ajax({data:"ac=getWallpaper"}).done(function(t){var i=t["wallpaper"].split("<{|}>");HROS.CONFIG.wallpaperState=parseInt(i[0]);switch(HROS.CONFIG.wallpaperState){case 1:case 2:HROS.CONFIG.wallpaper=i[1];HROS.CONFIG.wallpaperType=i[2];HROS.CONFIG.wallpaperWidth=parseInt(i[3]);HROS.CONFIG.wallpaperHeight=parseInt(i[4]);break;case 3:HROS.CONFIG.wallpaper=i[1];break}e&&e()})},set:function(e){var e=typeof e=="undefined"?true:e;if(e){$("#zoomWallpaperGrid").attr("id","zoomWallpaperGrid-ready2remove").css("zIndex",-11);setTimeout(function(){$("#zoomWallpaperGrid-ready2remove").remove();$("#zoomWallpaperGrid").removeClass("radi")},1500)}var t=$(window).width(),i=$(window).height();switch(HROS.CONFIG.wallpaperState){case 1:case 2:switch(HROS.CONFIG.wallpaperType){case"pingpu":if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;top:0;left:0;height:100%;width:100%;background:#fff url('+HROS.CONFIG.wallpaper+') repeat"></div>')}break;case"juzhong":if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;top:0;left:0;height:100%;width:100%;background:#fff url('+HROS.CONFIG.wallpaper+') no-repeat 50% 50%"></div>')}break;case"tianchong":var a=(i-HROS.CONFIG.wallpaperHeight)/2,s=(t-HROS.CONFIG.wallpaperWidth)/2;
if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;left:0;top:0;overflow:hidden;height:'+i+"px;width:"+t+'px;background:#fff"><img id="zoomWallpaper" src="'+HROS.CONFIG.wallpaper+'" style="position:absolute;height:'+HROS.CONFIG.wallpaperHeight+"px;width:"+HROS.CONFIG.wallpaperWidth+"px;top:"+a+"px;left:"+s+'px"><div style="position:absolute;height:'+i+"px;width:"+t+'px;background:#fff;opacity:0;filter:alpha(opacity=0)"></div></div>')}else{$("#zoomWallpaperGrid, #zoomWallpaperGrid div").css({height:i+"px",width:t+"px"});$("#zoomWallpaper").css({top:a+"px",left:s+"px"})}break;case"shiying":var o,n,a,s;if(HROS.CONFIG.wallpaperHeight/HROS.CONFIG.wallpaperWidth>i/t){o=i;n=HROS.CONFIG.wallpaperWidth*(i/HROS.CONFIG.wallpaperHeight);a=0;s=(t-n)/2}else if(HROS.CONFIG.wallpaperHeight/HROS.CONFIG.wallpaperWidth<i/t){n=t;o=HROS.CONFIG.wallpaperHeight*(t/HROS.CONFIG.wallpaperWidth);s=0;a=(i-o)/2}else{o=HROS.CONFIG.wallpaperHeight;n=HROS.CONFIG.wallpaperWidth;a=s=0}if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;left:0;top:0;overflow:hidden;height:'+i+"px;width:"+t+'px;background:#fff"><img id="zoomWallpaper" src="'+HROS.CONFIG.wallpaper+'" style="position:absolute;height:'+o+"px;width:"+n+"px;top:"+a+"px;left:"+s+'px"><div style="position:absolute;height:'+i+"px;width:"+t+'px;background:#fff;opacity:0;filter:alpha(opacity=0)"></div></div>')}else{$("#zoomWallpaperGrid, #zoomWallpaperGrid div").css({height:i+"px",width:t+"px"});$("#zoomWallpaper").css({height:o+"px",width:n+"px",top:a+"px",left:s+"px"})}break;case"lashen":if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;left:0;top:0;overflow:hidden;height:'+i+"px;width:"+t+'px;background:#fff"><img id="zoomWallpaper" src="'+HROS.CONFIG.wallpaper+'" style="position:absolute;height:'+i+"px;width:"+t+'px;top:0;left:0"><div style="position:absolute;height:'+i+"px;width:"+t+'px;background:#fff;opacity:0;filter:alpha(opacity=0)"></div></div>')}else{$("#zoomWallpaperGrid").css({height:i+"px",width:t+"px"}).children("#zoomWallpaper, div").css({height:i+"px",width:t+"px"})}break}break;case 3:if(e){$("body").append('<div id="zoomWallpaperGrid" class="radi" style="position:absolute;z-index:-10;top:0;left:0;height:100%;width:100%;overflow:hidden"><div></div><iframe id="iframeWallpaper" frameborder="no" border="0" scrolling="no" class="iframeWallpaper" style="position:absolute;left:0;top:0;overflow:hidden;width:100%;height:100%" src="'+HROS.CONFIG.wallpaper+'"></iframe></div>')}break}},update:function(e,t,i){function a(){HROS.wallpaper.get(function(){HROS.wallpaper.set()})}if(HROS.base.checkLogin()){$.ajax({data:"ac=setWallpaper&wpstate="+e+"&wptype="+t+"&wp="+i}).done(function(e){a()})}else{a()}}}}();HROS.widget=function(){return{init:function(){HROS.widget.handle();HROS.widget.move();HROS.widget.reduction();$("#desk").on("mouseover",".widget",function(){$(this).children(".move").show()}).on("mouseout",".widget",function(){$(this).children(".move").hide()})},createTemp:function(e){var t=e.appid==null?Date.parse(new Date):e.appid;var i=false;$("#desk .widget").each(function(){if($(this).attr("appid")==t){i=true;return false}});if(!i){function a(e){var t="#w_"+e.appid;TEMP.widgetTemp={width:e.width,height:e.height,type:"widgetTemp",id:"w_"+e.appid,appid:e.appid,realappid:e.appid,top:e.top,right:e.right,url:e.url,zIndex:HROS.CONFIG.widgetIndexid,issetbar:0};$("#desk").append(widgetWindowTemp(TEMP.widgetTemp));$(t).data("info",TEMP.widgetTemp).css({opacity:0,scale:1.1}).transition({opacity:1,scale:1},200);HROS.CONFIG.widgetIndexid+=1}a({appid:t,url:e.url,width:e.width,height:e.height,top:e.top==null?0:e.top,right:e.right==null?0:e.right})}},create:function(e,t,i){var t=t==null?"widget":t;var a=false;$("#desk .widget").each(function(){if($(this).attr("appid")==e){a=true;return false}});if(!a&&$("#d_"+e).attr("opening")!=1){$("#d_"+e).attr("opening",1);function s(i){var a="#w_"+i.appid;if(HROS.widget.checkCookie(e,t)){var s=JSON.parse(Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID));$(s).each(function(){if(this.appid==i.appid&&this.type==i.type){i.top=this.top;i.right=this.right}})}else{HROS.widget.addCookie(i.appid,i.type,0,0)}TEMP.widgetTemp={title:i.title,width:i.width,height:i.height,type:i.type,id:"w_"+i.appid,appid:i.appid,realappid:i.realappid==0?i.appid:i.realappid,top:typeof i.top=="undefined"?0:i.top,right:typeof i.right=="undefined"?0:i.right,url:i.url,zIndex:HROS.CONFIG.widgetIndexid,issetbar:1};$("#desk").append(widgetWindowTemp(TEMP.widgetTemp));$(a).data("info",TEMP.widgetTemp).css({opacity:0,scale:1.1}).transition({opacity:1,scale:1},200);HROS.CONFIG.widgetIndexid+=1}$.ajax({data:"ac=getMyAppById&id="+e+"&type="+t,dataType:"json"}).done(function(a){if(a!=null){if(a["error"]=="ERROR_NOT_FOUND"){swal({type:"error",title:"小挂件不存在，建议删除",timer:2e3,showConfirmButton:false});HROS.widget.removeCookie(e,t)}else if(a["error"]=="ERROR_NOT_INSTALLED"){HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php?id="+(i==null?$("#d_"+e).attr("realappid"):i),width:800,height:484,isflash:false,refresh:true});HROS.widget.removeCookie(e,t)}else{s({appid:a["appid"],realappid:a["realappid"],title:a["name"],url:a["url"],type:a["type"],width:a["width"],height:a["height"],top:0,right:0})}}else{swal({type:"error",title:"小挂件加载失败",timer:2e3,showConfirmButton:false})}$("#d_"+e).attr("opening",0)})}},reduction:function(){var e=Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID);if(typeof e!=="undefined"){e=JSON.parse(e);$(e).each(function(){HROS.widget.create(this.appid,this.type)})}},checkCookie:function(e,t){var i=false;var a=Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID);if(typeof a!=="undefined"){a=JSON.parse(a);$(a).each(function(){if(this.appid==e&&this.type==t){i=true}})}return i},addCookie:function(e,t,i,a){if(t=="widget"||t=="pwidget"){if(HROS.widget.checkCookie(e,t)){var s=JSON.parse(Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID));$(s).each(function(){if(this.appid==e&&this.type==t){this.top=i;this.right=a}})}else{var s=Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID);if(typeof s!=="undefined"){s=JSON.parse(s)}else{s=[]}s.push({appid:e,type:t,top:i,right:a})}Cookies.set(cookie_prefix+"widgetState"+HROS.CONFIG.memberID,$.toJSON(s),{expires:95})}},removeCookie:function(e,t){if(t=="widget"||t=="pwidget"){if(HROS.widget.checkCookie(e,t)){var i=JSON.parse(Cookies.get(cookie_prefix+"widgetState"+HROS.CONFIG.memberID));$(i).each(function(a){if(this.appid==e&&this.type==t){i.splice(a,1);return false}});Cookies.set(cookie_prefix+"widgetState"+HROS.CONFIG.memberID,$.toJSON(i),{expires:95})}}},move:function(){$("#desk").on("mousedown",".widget .move",function(e){var t=$(this).parents(".widget");HROS.widget.show2top(t.attr("appid"));var i=e.clientX-t.offset().left;var a=e.clientY-t.offset().top;var s;var o;var n;$(document).on("mousemove",function(e){s=HROS.maskBox.desk();s.show();o=e.clientY-a<0?0:e.clientY-a;n=$(window).width()-t.width()-(e.clientX-i);t.css({top:o,right:n})}).on("mouseup",function(){$(this).off("mousemove").off("mouseup");if(typeof s!=="undefined"){s.hide()}if(t.attr("type")!="widgetTemp"){HROS.widget.addCookie(t.attr("appid"),t.attr("type"),o,n)}})})},close:function(e){var t="#w_"+e;HROS.widget.removeCookie($(t).attr("appid"),$(t).attr("type"));$(t).css({opacity:1,scale:1}).transition({opacity:0,scale:1.1},200,function(){$(this).removeData("info").html("").remove()})},show2top:function(e){var t="#w_"+e;$(t).css("z-index",HROS.CONFIG.widgetIndexid);HROS.CONFIG.widgetIndexid+=1},handle:function(){$("#desk").on("mousedown",".widget a",function(e){e.preventDefault();e.stopPropagation()});$("#desk").on("click",".widget .ha-close",function(e){var t=$(this).parents(".widget");HROS.widget.close(t.attr("appid"))}).on("click",".widget .ha-star",function(){var e=$(this).parents(".widget");$.ajax({data:"ac=getAppStar&id="+e.data("info").realappid}).done(function(t){t=t["starnum"];dialog({title:"给“"+e.data("info").title+"”打分",padding:"10px 40px 15px 40px",id:"star",content:starDialogTemp({realappid:e.data("info").realappid,point:Math.floor(t),realpoint:t*20})}).showModal()})}).on("click",".widget .ha-share",function(){var e=$(this).parents(".widget");dialog({title:"分享应用",width:320,id:"share",content:shareDialogTemp({title:"我正在使用 %23HoorayOS%23 中的 %23"+e.data("info").title+"%23 应用，很不错哦，推荐你也来试试！",url:HROS.CONFIG.website+"?run="+e.data("info").realappid+"%26type=app"})}).showModal()})}}}();HROS.window=function(){return{init:function(){HROS.window.handle();HROS.window.move();HROS.window.resize();$("#desk").on("click",".window-container .window-mask, .window-container .folder_body",function(){HROS.window.show2top($(this).parents(".window-container").attr("appid"),true)});$("#desk").on("contextmenu",".window-container",function(){return false});$("#desk").on("click",".folder_body li",function(){return false}).on("contextmenu",".folder_body .appbtn",function(e){$(".popup-menu").hide();$(".quick_view_container").remove();switch($(this).attr("type")){case"window":case"widget":var t=HROS.popupMenu.app($(this));break;case"pwindow":case"pwidget":var t=HROS.popupMenu.papp($(this));break}var i=$(window).width()-e.clientX<t.width()?e.clientX-t.width():e.clientX;var a=$(window).height()-e.clientY<t.height()?e.clientY-t.height():e.clientY;t.css({left:i,top:a}).show();return false})},createTemp:function(e){var t="window",i=e.appid==null?Date.parse(new Date):e.appid;var a=false;$("#task-content-inner .task-item").each(function(){if($(this).attr("appid")==i){a=true;HROS.window.show2top($(this).attr("appid"));return false}});if(!a){function s(e){var t="#w_"+e.appid;$("#task-content-inner").append(taskTemp({type:e.type,id:"t_"+e.appid,appid:e.appid,realappid:e.appid,title:e.title,imgsrc:e.imgsrc}));HROS.taskBar.resize();TEMP.windowTemp={top:($(window).height()-e.height)/2<=0?0:($(window).height()-e.height)/2,left:($(window).width()-e.width)/2<=0?0:($(window).width()-e.width)/2,emptyW:$(window).width()-e.width,emptyH:$(window).height()-e.height,width:e.width,height:e.height,zIndex:HROS.CONFIG.windowIndexid,type:e.type,id:"w_"+e.appid,appid:e.appid,realappid:e.appid,title:e.title,url:e.url,imgsrc:e.imgsrc,isresize:e.isresize,isopenmax:e.isopenmax,istitlebar:e.isresize,istitlebarFullscreen:e.isresize?window.fullScreenApi.supportsFullScreen==true?true:false:false,issetbar:e.issetbar,isflash:e.isflash};$("#desk").append(windowTemp(TEMP.windowTemp));$(t).data("info",TEMP.windowTemp).css({opacity:0,scale:1.1}).transition({opacity:1,scale:1},200);HROS.CONFIG.windowIndexid+=1;HROS.window.show2top(e.appid)}s({type:t,appid:i,realappid:i,imgsrc:"static/img/ui/default_icon.png",title:e.title,url:e.url,width:e.width,height:e.height,isresize:typeof e.isresize=="undefined"?false:e.isresize,isopenmax:typeof e.isopenmax=="undefined"?false:e.isopenmax,issetbar:false,isflash:typeof e.isflash=="undefined"?true:e.isflash})}else{if(e.refresh){var o="#w_"+i;$(o).find("iframe").attr("src",e.url)}}},create:function(e,t,i){var t=t==null?"window":t;var a=false;$("#task-content-inner .task-item").each(function(){if($(this).attr("appid")==e){a=true;HROS.window.show2top(e);return false}});if(!a&&$("#d_"+e).attr("opening")!=1){$("#d_"+e).attr("opening",1);function s(e){var t="#w_"+e.appid;var i=($(window).height()-e.height)/2<=0?0:($(window).height()-e.height)/2;var a=($(window).width()-e.width)/2<=0?0:($(window).width()-e.width)/2;switch(e.type){case"window":case"pwindow":$("#task-content-inner").append(taskTemp({type:e.type,id:"t_"+e.appid,appid:e.appid,realappid:e.realappid,title:e.title,imgsrc:e.imgsrc}));HROS.taskBar.resize();TEMP.windowTemp={top:i,left:a,emptyW:$(window).width()-e.width,emptyH:$(window).height()-e.height,width:e.width,height:e.height,zIndex:HROS.CONFIG.windowIndexid,type:e.type,id:"w_"+e.appid,appid:e.appid,realappid:e.realappid,title:e.title,url:e.url,imgsrc:e.imgsrc,isresize:e.isresize==1?true:false,isopenmax:e.isresize==1?e.isopenmax==1?true:false:false,istitlebar:e.isresize==1?true:false,istitlebarFullscreen:e.isresize==1?window.fullScreenApi.supportsFullScreen==true?true:false:false,issetbar:e.issetbar==1?true:false,isflash:e.isflash==1?true:false};$("#desk").append(windowTemp(TEMP.windowTemp));$(t).data("info",TEMP.windowTemp).css({opacity:0,scale:1.1}).transition({opacity:1,scale:1},200);HROS.CONFIG.windowIndexid+=1;HROS.window.show2top(e.appid);break;case"folder":$("#task-content-inner").append(taskTemp({type:e.type,id:"t_"+e.appid,appid:e.appid,realappid:e.realappid,title:e.title,imgsrc:e.imgsrc}));HROS.taskBar.resize();TEMP.folderWindowTemp={top:i,left:a,emptyW:$(window).width()-e.width,emptyH:$(window).height()-e.height,width:e.width,height:e.height,zIndex:HROS.CONFIG.windowIndexid,type:e.type,id:"w_"+e.appid,appid:e.appid,realappid:e.realappid,title:e.title,imgsrc:e.imgsrc};$("#desk").append(folderWindowTemp(TEMP.folderWindowTemp));$(t).data("info",TEMP.folderWindowTemp).css({opacity:0,scale:1.1}).transition({opacity:1,scale:1},200);HROS.CONFIG.windowIndexid+=1;var s="";$(HROS.VAR.folder).each(function(){if(this.appid==e.appid){s=this.apps;return false}});if(s!=""){var o="";$(s).each(function(){o+=appbtnTemp({title:this.name,type:this.type,id:"d_"+this.appid,appid:this.appid,realappid:this.realappid,imgsrc:this.icon,appsize:48})});$(t).find(".folder_body").append(o)}HROS.window.show2top(e.appid);break;case"file":TEMP.fileWindowTemp={top:i,left:a,emptyW:$(window).width()-e.width,emptyH:$(window).height()-e.height,width:e.width,height:e.height,zIndex:HROS.CONFIG.windowIndexid,type:e.type,id:"w_"+e.appid,appid:e.appid,realappid:e.realappid,title:e.title,imgsrc:e.imgsrc};$("body").append(fileDownloadTemp(TEMP.fileWindowTemp));break}}$.ajax({data:"ac=getMyAppById&id="+e+"&type="+t,dataType:"json"}).done(function(t){if(t!=null){if(t["error"]=="ERROR_NOT_FOUND"){swal({type:"error",title:"应用不存在，建议删除",timer:2e3,showConfirmButton:false})}else if(t["error"]=="ERROR_NOT_INSTALLED"){HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php?id="+(i==null?$("#d_"+e).attr("realappid"):i),width:800,height:484,isflash:false,refresh:true})}else{s({type:t["type"],appid:t["appid"],realappid:t["realappid"],title:t["name"],imgsrc:t["icon"],url:t["url"],width:t["width"],height:t["height"],isresize:t["isresize"],isopenmax:t["isopenmax"],issetbar:t["issetbar"],isflash:t["isflash"]})}}else{swal({type:"error",title:"应用加载失败",timer:2e3,showConfirmButton:false})}$("#d_"+e).attr("opening",0)})}},setPos:function(){$("#desk .window-container").each(function(){var e=$(this).data("info");var t=$(window).width()-$(this).width();var i=$(window).height()-$(this).height();var a=e["left"]/e["emptyW"]*t>=t?t:e["left"]/e["emptyW"]*t;a=a<=0?0:a;var s=e["top"]/e["emptyH"]*i>=i?i:e["top"]/e["emptyH"]*i;s=s<=0?0:s;if($(this).attr("state")!="hide"){$(this).stop(true,false).animate({left:a,top:s},500,function(){e["left"]=a;e["top"]=s;e["emptyW"]=$(window).width()-$(this).width();e["emptyH"]=$(window).height()-$(this).height()})}else{e["left"]=a;e["top"]=s;e["emptyW"]=$(window).width()-$(this).width();e["emptyH"]=$(window).height()-$(this).height()}})},close:function(e){var t="#w_"+e,i="#t_"+e;$(t).css({opacity:1,scale:1}).transition({opacity:0,scale:1.1},200,function(){$(this).removeData("info").html("").remove()});$("#task-content-inner "+i).html("").remove();var a=true;$("#desk .window-container").each(function(){if($(this).attr("state")=="show"&&$(this).attr("ismax")==1){a=false}});if(a){$("#task-bar").removeClass("min-zIndex")}HROS.taskBar.resize()},closeAll:function(){$("#desk .window-container").each(function(){HROS.window.close($(this).attr("appid"))})},hide:function(e){var t="#w_"+e,i="#t_"+e;$(t).css({opacity:1,scale:1,y:0}).transition({opacity:0,scale:.9,y:50},200,function(){$(this).css("left",-1e4).attr("state","hide")});$("#task-content-inner "+i).removeClass("task-item-current");if($(t).attr("ismax")==1){$("#task-bar").removeClass("min-zIndex")}},hideAll:function(){$("#task-content-inner .task-item").removeClass("task-item-current");$("#desk-"+HROS.CONFIG.desk).nextAll("div.window-container").css("left",-1e4).attr("state","hide")},max:function(e){HROS.window.show2top(e);var t="#w_"+e,i="#t_"+e;$(t+" .title-handle .ha-max").hide().next(".ha-revert").show();$(t).addClass("window-maximize").attr("ismax",1).animate({width:"100%",height:"100%",top:0,left:0},200);$("#task-bar").addClass("min-zIndex")},revert:function(e){HROS.window.show2top(e);var t="#w_"+e,i="#t_"+e,a=$(t).data("info");$(t+" .title-handle .ha-revert").hide().prev(".ha-max").show();$(t).removeClass("window-maximize").attr("ismax",0).animate({width:a["width"],height:a["height"],left:a["left"],top:a["top"]},500);$("#task-bar").removeClass("min-zIndex")},refresh:function(e){HROS.window.show2top(e);var t="#w_"+e,i="#t_"+e;if($(t+"_iframe").length!=0){$(t+"_iframe").attr("src",$(t+"_iframe").attr("src"))}else{HROS.window.updateFolder(e)}},show2top:function(e,t){t=t==null?false:t;var i="#w_"+e,a="#t_"+e,s=$(i).data("info");var o=[];function n(){HROS.window.show2under();$("#task-content-inner "+a).addClass("task-item-current");if($(i).attr("ismax")==1){$("#task-bar").addClass("min-zIndex")}$(i).addClass("window-current").css({zIndex:HROS.CONFIG.windowIndexid,left:s["left"],top:s["top"]});if($(i).attr("ismax")==1){$(i).css({left:0,top:0})}$(i+" .window-mask").hide();$(i+" iframe").show();HROS.CONFIG.windowIndexid+=1;if($(i).attr("state")=="hide"){$(i).css({opacity:0,scale:.9,y:50}).transition({opacity:1,scale:1,y:0},200,function(){$(this).attr("state","show")})}}if(t){var r=$(i).offset().left,p=r+$(i).width();var d=$(i).offset().top,l=d+$(i).height();var c=r+$(i).width()/2,f=d+$(i).height()/2;var h=parseInt($(i).css("zIndex"));$("#desk .window-container:not("+i+")").each(function(){var e=$(this).offset().left,t=e+$(this).width();var i=$(this).offset().top,a=i+$(this).height();var s=e+$(this).width()/2,n=i+$(this).height()/2;var u=parseInt($(this).css("zIndex"));var w="";if(u>h){if(e>=r&&e<=p&&i>=d&&i<=l||e>=r&&e<=p&&a>=d&&a<=l||t>=r&&t<=p&&i>=d&&i<=l||t>=r&&t<=p&&a>=d&&a<=l){w="x"}if(e>=r&&e<=p&&i<d&&a>l||t>=r&&t<=p&&i<d&&a>l){w="x"}if(i>=d&&i<=l&&e<r&&t>p||a>=d&&a<=l&&e<r&&t>p){w="y"}if(e>=r&&e<=p&&a>=d&&a<=l&&(t>=r&&t<=p&&a>=d&&a<=l)||e>=r&&e<=p&&i>=d&&i<=l&&(t>=r&&t<=p&&i>=d&&i<=l)){w="y"}}if(w!=""){var m,k;if(w=="x"){if(s>c){m="right";k=p-e+30}else{m="left";k=t-r+30}}else{if(n>f){m="bottom";k=l-i+30}else{m="top";k=a-d+30}}o.push({id:$(this).attr("id"),direction:m,distance:k})}});var u=0;for(var w=0;w<o.length;w++){var m=$("#"+o[w].id).offset().left,k=$("#"+o[w].id).offset().top;if(o[w].direction=="left"){$("#"+o[w].id).delay(u).animate({left:m-o[w].distance},300).animate({left:m},300)}else if(o[w].direction=="right"){$("#"+o[w].id).delay(u).animate({left:m+o[w].distance},300).animate({left:m},300)}else if(o[w].direction=="top"){$("#"+o[w].id).delay(u).animate({top:k-o[w].distance},300).animate({top:k},300)}else if(o[w].direction=="bottom"){$("#"+o[w].id).delay(u).animate({top:k+o[w].distance},300).animate({top:k},300)}u+=100}setTimeout(n,u+100)}else{n()}},show2under:function(){$("#task-content-inner .task-item").removeClass("task-item-current");$("#desk .window-container").removeClass("window-current");$("#desk .window-container .window-mask").show();$("#desk .window-container-flash iframe").hide()},updateFolder:function(e){var t="#w_"+e,i="#t_"+e;var a="";$(HROS.VAR.folder).each(function(){if(this.appid==e){a=this.apps;return false}});if(a!=null){var s="";for(var o=0;o<a.length;o++){s+=appbtnTemp({top:0,left:0,title:a[o]["name"],type:a[o]["type"],id:"d_"+a[o]["appid"],appid:a[o]["appid"],realappid:a[o]["realappid"],imgsrc:a[o]["icon"],appsize:48})}$(t).find(".folder_body").html("").append(s).on("contextmenu",".appbtn",function(e){$(".popup-menu").hide();$(".quick_view_container").remove();TEMP.AppRight=HROS.popupMenu.app($(this));var t=$(window).width()-e.clientX<TEMP.AppRight.width()?e.clientX-TEMP.AppRight.width():e.clientX;var i=$(window).height()-e.clientY<TEMP.AppRight.height()?e.clientY-TEMP.AppRight.height():e.clientY;TEMP.AppRight.css({left:t,top:i}).show();return false})}},handle:function(){$("#desk").on("mousedown",".window-container .title-bar .title-handle a, .window-container .set-bar a",function(e){e.preventDefault();e.stopPropagation()});$("#desk").on("dblclick",".window-container .title-bar .title",function(e){console.log(1);var t=$(this).parents(".window-container");if(t.find(".ha-max").is(":hidden")){t.find(".ha-revert").click()}else{t.find(".ha-max").click()}}).on("click",".window-container .set-bar",function(){var e=$(this).parents(".window-container");HROS.window.show2top(e.attr("appid"))}).on("click",".window-container .ha-hide",function(){var e=$(this).parents(".window-container");HROS.window.hide(e.attr("appid"))}).on("click",".window-container .ha-max",function(){var e=$(this).parents(".window-container");HROS.window.max(e.attr("appid"))}).on("click",".window-container .ha-revert",function(){var e=$(this).parents(".window-container");HROS.window.revert(e.attr("appid"))}).on("click",".window-container .ha-fullscreen",function(){var e=$(this).parents(".window-container");window.fullScreenApi.requestFullScreen(document.getElementById(e.find("iframe").attr("id")))}).on("click",".window-container .ha-close",function(){var e=$(this).parents(".window-container");HROS.window.close(e.attr("appid"))}).on("click",".window-container .refresh",function(){var e=$(this).parents(".window-container");HROS.window.refresh(e.attr("appid"))}).on("click",".window-container .detail",function(){var e=$(this).parents(".window-container");if(e.attr("realappid")!==0){HROS.window.createTemp({appid:"hoorayos-yysc",title:"应用市场",url:"sysapp/appmarket/index.php?id="+e.attr("realappid"),width:800,height:484,isflash:false,refresh:true})}else{swal({type:"warning",title:"温馨提示",text:"该应用没有任何详细介绍",timer:2e3,showConfirmButton:false})}}).on("click",".window-container .star",function(){var e=$(this).parents(".window-container");$.ajax({data:"ac=getAppStar&id="+e.data("info").realappid}).done(function(t){t=t["starnum"];dialog({title:"给“"+e.data("info").title+"”打分",padding:"10px 40px 15px 40px",id:"star",content:starDialogTemp({realappid:e.data("info").realappid,point:Math.floor(t),realpoint:t*20})}).showModal()})}).on("click",".window-container .share",function(){var e=$(this).parents(".window-container");dialog({title:"分享应用",width:320,id:"share",content:shareDialogTemp({title:"我正在使用 %23HoorayOS%23 中的 %23"+e.data("info").title+"%23 应用，很不错哦，推荐你也来试试！",url:HROS.CONFIG.website+"?run="+e.data("info").realappid+"%26type=app"})}).showModal()}).on("contextmenu",".window-container",function(){$(".popup-menu").hide();$(".quick_view_container").remove();return false})},move:function(){$("#desk").on("mousedown",".window-container .title-bar, .window-container .set-bar",function(e){var t=$(this).parents(".window-container");if(t.attr("ismax")==1){return false}HROS.window.show2top(t.attr("appid"));var i=t.data("info");var a=e.clientX-t.offset().left;var s=e.clientY-t.offset().top;var o;$(document).on("mousemove",function(e){o=HROS.maskBox.desk();o.show();t.find(".ha-revert").hide().prev(".ha-max").show();t.css({width:i["width"],height:i["height"],left:e.clientX-a,top:e.clientY-s<=10?0:e.clientY-s>=o.height()-30?o.height()-30:e.clientY-s});t.data("info").left=t.offset().left;t.data("info").top=t.offset().top}).on("mouseup",function(){$(this).off("mousemove").off("mouseup");if(typeof o!=="undefined"){o.hide()}})})},resize:function(e){$("#desk").on("mousedown",".window-container .window-resize",function(e){var t=$(this).parents(".window-container");var i=$(this);var a;var s=e.clientX;var o=e.clientY;var n=t.width();var r=t.height();$(document).on("mousemove",function(e){a=HROS.maskBox.desk();a.show();var p=e.clientX<=10?0:e.clientX>=a.width()-12?a.width()-2:e.clientX;var d=e.clientY<=10?0:e.clientY>=a.height()-12?a.height():e.clientY;switch(i.attr("resize")){case"t":r+o-d>HROS.CONFIG.windowMinHeight?t.css({height:r+o-d,top:d}):t.css({height:HROS.CONFIG.windowMinHeight});break;case"r":n-s+p>HROS.CONFIG.windowMinWidth?t.css({width:n-s+p}):t.css({width:HROS.CONFIG.windowMinWidth});break;case"b":r-o+d>HROS.CONFIG.windowMinHeight?t.css({height:r-o+d}):t.css({height:HROS.CONFIG.windowMinHeight});break;case"l":n+s-p>HROS.CONFIG.windowMinWidth?t.css({width:n+s-p,left:p}):t.css({width:HROS.CONFIG.windowMinWidth});break;case"rt":r+o-d>HROS.CONFIG.windowMinHeight?t.css({height:r+o-d,top:d}):t.css({height:HROS.CONFIG.windowMinHeight});n-s+p>HROS.CONFIG.windowMinWidth?t.css({width:n-s+p}):t.css({width:HROS.CONFIG.windowMinWidth});break;case"rb":n-s+p>HROS.CONFIG.windowMinWidth?t.css({width:n-s+p}):t.css({width:HROS.CONFIG.windowMinWidth});r-o+d>HROS.CONFIG.windowMinHeight?t.css({height:r-o+d}):t.css({height:HROS.CONFIG.windowMinHeight});break;case"lt":n+s-p>HROS.CONFIG.windowMinWidth?t.css({width:n+s-p,left:p}):t.css({width:HROS.CONFIG.windowMinWidth});r+o-d>HROS.CONFIG.windowMinHeight?t.css({height:r+o-d,top:d}):t.css({height:HROS.CONFIG.windowMinHeight});break;case"lb":n+s-p>HROS.CONFIG.windowMinWidth?t.css({width:n+s-p,left:p}):t.css({width:HROS.CONFIG.windowMinWidth});r-o+d>HROS.CONFIG.windowMinHeight?t.css({height:r-o+d}):t.css({height:HROS.CONFIG.windowMinHeight});break}}).on("mouseup",function(){if(typeof a!=="undefined"){a.hide()}t.data("info").width=t.width();t.data("info").height=t.height();t.data("info").left=t.offset().left;t.data("info").top=t.offset().top;t.data("info").emptyW=$(window).width()-t.width();t.data("info").emptyH=$(window).height()-t.height();$(this).off("mousemove").off("mouseup")})})}}}();HROS.zoom=function(){return{init:function(){$("body").append('<div id="zoombox"></div>');swfobject.embedSWF("static/js/zoom.swf?onchange=HROS.zoom.check",document.getElementById("zoombox"),10,10,10,"expressInstall.swf","",{allowScriptAccess:"always",wmode:"transparent",scale:"noScale"},{id:"accessory_zoom",name:"zoom_detect"})},check:function(e){var t=e.scale,i=t>1?"放大":"缩小";if(t!=1){HROS.VAR.zoomLevel=t;$("#zoom-tip").show().find("span").text("您的浏览器目前处于"+i+"状态，会导致显示不正常，您可以键盘按“ctrl+数字0”组合键恢复初始状态！")}else{if(t!=HROS.VAR.zoomLevel){$("#zoom-tip").fadeOut()}}},close:function(){$("#zoom-tip").remove()}}}();